(function(n){n.widget("thomaskahn.smoothDivScroll",{options:{scrollingHotSpotLeftClass:"scrollingHotSpotLeft",scrollingHotSpotRightClass:"scrollingHotSpotRight",scrollableAreaClass:"scrollableArea",scrollWrapperClass:"scrollWrapper",hiddenOnStart:!1,getContentOnLoad:{},countOnlyClass:"",startAtElementId:"",hotSpotScrolling:!0,hotSpotScrollingStep:15,hotSpotScrollingInterval:10,hotSpotMouseDownSpeedBooster:3,visibleHotSpotBackgrounds:"hover",hotSpotsVisibleTime:5e3,easingAfterHotSpotScrolling:!0,easingAfterHotSpotScrollingDistance:10,easingAfterHotSpotScrollingDuration:300,easingAfterHotSpotScrollingFunction:"easeOutQuart",mousewheelScrolling:"",mousewheelScrollingStep:70,easingAfterMouseWheelScrolling:!0,easingAfterMouseWheelScrollingDuration:300,easingAfterMouseWheelScrollingFunction:"easeOutQuart",manualContinuousScrolling:!1,autoScrollingMode:"",autoScrollingDirection:"endlessLoopRight",autoScrollingStep:1,autoScrollingInterval:10,touchScrolling:!1,scrollToAnimationDuration:1e3,scrollToEasingFunction:"easeOutQuart"},_create:function(){var r=this,i=this.options,t=this.element;t.data("scrollWrapper",t.find("."+i.scrollWrapperClass));t.data("scrollingHotSpotRight",t.find("."+i.scrollingHotSpotRightClass));t.data("scrollingHotSpotLeft",t.find("."+i.scrollingHotSpotLeftClass));t.data("scrollableArea",t.find("."+i.scrollableAreaClass));t.data("scrollingHotSpotRight").length>0&&t.data("scrollingHotSpotRight").detach();t.data("scrollingHotSpotLeft").length>0&&t.data("scrollingHotSpotLeft").detach();t.data("scrollableArea").length===0&&t.data("scrollWrapper").length===0?(t.wrapInner("<div class='"+i.scrollableAreaClass+"'>").wrapInner("<div class='"+i.scrollWrapperClass+"'>"),t.data("scrollWrapper",t.find("."+i.scrollWrapperClass)),t.data("scrollableArea",t.find("."+i.scrollableAreaClass))):t.data("scrollWrapper").length===0?(t.wrapInner("<div class='"+i.scrollWrapperClass+"'>"),t.data("scrollWrapper",t.find("."+i.scrollWrapperClass))):t.data("scrollableArea").length===0&&(t.data("scrollWrapper").wrapInner("<div class='"+i.scrollableAreaClass+"'>"),t.data("scrollableArea",t.find("."+i.scrollableAreaClass)));t.data("scrollingHotSpotRight").length===0?(t.prepend("<div class='"+i.scrollingHotSpotRightClass+" hidden'><\/div>"),t.data("scrollingHotSpotRight",t.find("."+i.scrollingHotSpotRightClass))):t.prepend(t.data("scrollingHotSpotRight"));t.data("scrollingHotSpotLeft").length===0?(t.prepend("<div class='"+i.scrollingHotSpotLeftClass+" hidden'><\/div>"),t.data("scrollingHotSpotLeft",t.find("."+i.scrollingHotSpotLeftClass))):t.prepend(t.data("scrollingHotSpotLeft"));t.data("speedBooster",1);t.data("scrollXPos",0);t.data("hotSpotWidth",t.data("scrollingHotSpotLeft").innerWidth());t.data("scrollableAreaWidth",0);t.data("startingPosition",0);t.data("rightScrollingInterval",null);t.data("leftScrollingInterval",null);t.data("autoScrollingInterval",null);t.data("hideHotSpotBackgroundsInterval",null);t.data("previousScrollLeft",0);t.data("pingPongDirection","right");t.data("getNextElementWidth",!0);t.data("swapAt",null);t.data("startAtElementHasNotPassed",!0);t.data("swappedElement",null);t.data("originalElements",t.data("scrollableArea").children(i.countOnlyClass));t.data("visible",!0);t.data("enabled",!0);t.data("scrollableAreaHeight",t.data("scrollableArea").height());t.data("scrollerOffset",t.offset());i.touchScrolling&&t.data("enabled")&&t.data("scrollWrapper").kinetic({y:!1,moved:function(){i.manualContinuousScrolling&&(t.data("scrollWrapper").scrollLeft()<=0?r._checkContinuousSwapLeft():r._checkContinuousSwapRight());r._showHideHotSpots()},stopped:function(){t.data("scrollWrapper").stop(!0,!1);r.stopAutoScrolling()}});t.data("scrollingHotSpotRight").bind("mousemove",function(n){if(i.hotSpotScrolling){var r=n.pageX-(this.offsetLeft+t.data("scrollerOffset").left);t.data("scrollXPos",Math.round(r/t.data("hotSpotWidth")*i.hotSpotScrollingStep));(t.data("scrollXPos")===Infinity||t.data("scrollXPos")<1)&&t.data("scrollXPos",1)}});t.data("scrollingHotSpotRight").bind("mouseover",function(){i.hotSpotScrolling&&(t.data("scrollWrapper").stop(!0,!1),r.stopAutoScrolling(),t.data("rightScrollingInterval",setInterval(function(){t.data("scrollXPos")>0&&t.data("enabled")&&(t.data("scrollWrapper").scrollLeft(t.data("scrollWrapper").scrollLeft()+1*t.data("speedBooster")),i.manualContinuousScrolling&&r._checkContinuousSwapRight(),r._showHideHotSpots())},i.hotSpotScrollingInterval)),r._trigger("mouseOverRightHotSpot"))});t.data("scrollingHotSpotRight").bind("mouseout",function(){i.hotSpotScrolling&&(clearInterval(t.data("rightScrollingInterval")),t.data("scrollXPos",0),i.easingAfterHotSpotScrolling&&t.data("enabled")&&t.data("scrollWrapper").animate({scrollLeft:t.data("scrollWrapper").scrollLeft()+i.easingAfterHotSpotScrollingDistance},{duration:i.easingAfterHotSpotScrollingDuration,easing:i.easingAfterHotSpotScrollingFunction}))});t.data("scrollingHotSpotRight").bind("mousedown",function(){t.data("speedBooster",i.hotSpotMouseDownSpeedBooster)});n("body").bind("mouseup",function(){t.data("speedBooster",1)});t.data("scrollingHotSpotLeft").bind("mousemove",function(n){if(i.hotSpotScrolling){var r=this.offsetLeft+t.data("scrollerOffset").left+t.data("hotSpotWidth")-n.pageX;t.data("scrollXPos",Math.round(r/t.data("hotSpotWidth")*i.hotSpotScrollingStep));(t.data("scrollXPos")===Infinity||t.data("scrollXPos")<1)&&t.data("scrollXPos",1)}});t.data("scrollingHotSpotLeft").bind("mouseover",function(){i.hotSpotScrolling&&(t.data("scrollWrapper").stop(!0,!1),r.stopAutoScrolling(),t.data("leftScrollingInterval",setInterval(function(){t.data("scrollXPos")>0&&t.data("enabled")&&(t.data("scrollWrapper").scrollLeft(t.data("scrollWrapper").scrollLeft()-1*t.data("speedBooster")),i.manualContinuousScrolling&&r._checkContinuousSwapLeft(),r._showHideHotSpots())},i.hotSpotScrollingInterval)),r._trigger("mouseOverLeftHotSpot"))});t.data("scrollingHotSpotLeft").bind("mouseout",function(){i.hotSpotScrolling&&(clearInterval(t.data("leftScrollingInterval")),t.data("scrollXPos",0),i.easingAfterHotSpotScrolling&&t.data("enabled")&&t.data("scrollWrapper").animate({scrollLeft:t.data("scrollWrapper").scrollLeft()-i.easingAfterHotSpotScrollingDistance},{duration:i.easingAfterHotSpotScrollingDuration,easing:i.easingAfterHotSpotScrollingFunction}))});t.data("scrollingHotSpotLeft").bind("mousedown",function(){t.data("speedBooster",i.hotSpotMouseDownSpeedBooster)});t.data("scrollableArea").mousewheel(function(n,u,f,e){if(t.data("enabled")&&i.mousewheelScrolling.length>0){var o;i.mousewheelScrolling==="vertical"&&e!==0?(r.stopAutoScrolling(),n.preventDefault(),o=Math.round(i.mousewheelScrollingStep*e*-1),r.move(o)):i.mousewheelScrolling==="horizontal"&&f!==0?(r.stopAutoScrolling(),n.preventDefault(),o=Math.round(i.mousewheelScrollingStep*f*-1),r.move(o)):i.mousewheelScrolling==="allDirections"&&(r.stopAutoScrolling(),n.preventDefault(),o=Math.round(i.mousewheelScrollingStep*u*-1),r.move(o))}});i.mousewheelScrolling&&t.data("scrollingHotSpotLeft").add(t.data("scrollingHotSpotRight")).mousewheel(function(n){n.preventDefault()});n(window).bind("resize",function(){r._showHideHotSpots();r._trigger("windowResized")});jQuery.isEmptyObject(i.getContentOnLoad)||r[i.getContentOnLoad.method](i.getContentOnLoad.content,i.getContentOnLoad.manipulationMethod,i.getContentOnLoad.addWhere,i.getContentOnLoad.filterTag);i.hiddenOnStart&&r.hide();n(window).load(function(){if(i.hiddenOnStart||r.recalculateScrollableArea(),i.autoScrollingMode.length>0&&!i.hiddenOnStart&&r.startAutoScrolling(),i.autoScrollingMode!=="always")switch(i.visibleHotSpotBackgrounds){case"always":r.showHotSpotBackgrounds();break;case"onStart":r.showHotSpotBackgrounds();t.data("hideHotSpotBackgroundsInterval",setTimeout(function(){r.hideHotSpotBackgrounds(250)},i.hotSpotsVisibleTime));break;case"hover":t.mouseenter(function(n){i.hotSpotScrolling&&(n.stopPropagation(),r.showHotSpotBackgrounds(250))}).mouseleave(function(n){i.hotSpotScrolling&&(n.stopPropagation(),r.hideHotSpotBackgrounds(250))})}r._showHideHotSpots();r._trigger("setupComplete")})},_setOption:function(n,t){var r=this,i=this.options,u=this.element;i[n]=t;n==="hotSpotScrolling"?t===!0?r._showHideHotSpots():(u.data("scrollingHotSpotLeft").hide(),u.data("scrollingHotSpotRight").hide()):n==="autoScrollingStep"||n==="easingAfterHotSpotScrollingDistance"||n==="easingAfterHotSpotScrollingDuration"||n==="easingAfterMouseWheelScrollingDuration"?i[n]=parseInt(t,10):n==="autoScrollingInterval"&&(i[n]=parseInt(t,10),r.startAutoScrolling())},showHotSpotBackgrounds:function(n){var i=this,t=this.element,r=this.option;n!==undefined?(t.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible"),t.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible"),t.data("scrollingHotSpotLeft").add(t.data("scrollingHotSpotRight")).fadeTo(n,.35)):(t.data("scrollingHotSpotLeft").addClass("scrollingHotSpotLeftVisible"),t.data("scrollingHotSpotLeft").removeAttr("style"),t.data("scrollingHotSpotRight").addClass("scrollingHotSpotRightVisible"),t.data("scrollingHotSpotRight").removeAttr("style"));i._showHideHotSpots()},hideHotSpotBackgrounds:function(n){var t=this.element,i=this.option;n!==undefined?(t.data("scrollingHotSpotLeft").fadeTo(n,0,function(){t.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible")}),t.data("scrollingHotSpotRight").fadeTo(n,0,function(){t.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible")})):(t.data("scrollingHotSpotLeft").removeClass("scrollingHotSpotLeftVisible").removeAttr("style"),t.data("scrollingHotSpotRight").removeClass("scrollingHotSpotRightVisible").removeAttr("style"))},_showHideHotSpots:function(){var i=this,n=this.element,t=this.options;t.hotSpotScrolling?t.manualContinuousScrolling&&t.hotSpotScrolling&&t.autoScrollingMode!=="always"?(n.data("scrollingHotSpotLeft").toggleClass("hidden",!1),n.data("scrollingHotSpotRight").toggleClass("hidden",!1)):t.autoScrollingMode!=="always"&&t.hotSpotScrolling?n.data("scrollableAreaWidth")<=n.data("scrollWrapper").innerWidth()?(n.data("scrollingHotSpotLeft").toggleClass("hidden",!0),n.data("scrollingHotSpotRight").toggleClass("hidden",!0)):n.data("scrollWrapper").scrollLeft()===0?(n.data("scrollingHotSpotLeft").toggleClass("hidden",!0),n.data("scrollingHotSpotRight").toggleClass("hidden",!1),i._trigger("scrollerLeftLimitReached"),clearInterval(n.data("leftScrollingInterval")),n.data("leftScrollingInterval",null)):n.data("scrollableAreaWidth")<=n.data("scrollWrapper").innerWidth()+n.data("scrollWrapper").scrollLeft()?(n.data("scrollingHotSpotLeft").toggleClass("hidden",!1),n.data("scrollingHotSpotRight").toggleClass("hidden",!0),i._trigger("scrollerRightLimitReached"),clearInterval(n.data("rightScrollingInterval")),n.data("rightScrollingInterval",null)):(n.data("scrollingHotSpotLeft").toggleClass("hidden",!1),n.data("scrollingHotSpotRight").toggleClass("hidden",!1)):(n.data("scrollingHotSpotLeft").hide().toggleClass("hidden",!0),n.data("scrollingHotSpotRight").hide().toggleClass("hidden",!0)):(n.data("scrollingHotSpotLeft").toggleClass("hidden",!0),n.data("scrollingHotSpotRight").toggleClass("hidden",!0))},_setElementScrollPosition:function(t,i){var r=this.element,f=this.options,u=0;switch(t){case"first":return r.data("scrollXPos",0),!0;case"start":return f.startAtElementId!==""&&r.data("scrollableArea").has("#"+f.startAtElementId)?(u=n("#"+f.startAtElementId).position().left,r.data("scrollXPos",u),!0):!1;case"last":return r.data("scrollXPos",r.data("scrollableAreaWidth")-r.data("scrollWrapper").innerWidth()),!0;case"number":return isNaN(i)?!1:(u=r.data("scrollableArea").children(f.countOnlyClass).eq(i-1).position().left,r.data("scrollXPos",u),!0);case"id":return i.length>0&&r.data("scrollableArea").has("#"+i)?(u=n("#"+i).position().left,r.data("scrollXPos",u),!0):!1;default:return!1}},jumpToElement:function(n,t){var i=this,r=this.element;if(r.data("enabled")&&i._setElementScrollPosition(n,t)){r.data("scrollWrapper").scrollLeft(r.data("scrollXPos"));i._showHideHotSpots();switch(n){case"first":i._trigger("jumpedToFirstElement");break;case"start":i._trigger("jumpedToStartElement");break;case"last":i._trigger("jumpedToLastElement");break;case"number":i._trigger("jumpedToElementNumber",null,{elementNumber:t});break;case"id":i._trigger("jumpedToElementId",null,{elementId:t})}}},scrollToElement:function(n,t){var i=this,r=this.element,u=this.options,f=!1;r.data("enabled")&&i._setElementScrollPosition(n,t)&&(r.data("autoScrollingInterval")!==null&&(i.stopAutoScrolling(),f=!0),r.data("scrollWrapper").stop(!0,!1),r.data("scrollWrapper").animate({scrollLeft:r.data("scrollXPos")},{duration:u.scrollToAnimationDuration,easing:u.scrollToEasingFunction,complete:function(){f&&i.startAutoScrolling();i._showHideHotSpots();switch(n){case"first":i._trigger("scrolledToFirstElement");break;case"start":i._trigger("scrolledToStartElement");break;case"last":i._trigger("scrolledToLastElement");break;case"number":i._trigger("scrolledToElementNumber",null,{elementNumber:t});break;case"id":i._trigger("scrolledToElementId",null,{elementId:t})}}}))},move:function(n){var i=this,t=this.element,r=this.options;t.data("scrollWrapper").stop(!0,!0);(n<0&&t.data("scrollWrapper").scrollLeft()>0||n>0&&t.data("scrollableAreaWidth")>t.data("scrollWrapper").innerWidth()+t.data("scrollWrapper").scrollLeft())&&(r.easingAfterMouseWheelScrolling?t.data("scrollWrapper").animate({scrollLeft:t.data("scrollWrapper").scrollLeft()+n},{duration:r.easingAfterMouseWheelScrollingDuration,easing:r.easingAfterMouseWheelFunction,complete:function(){i._showHideHotSpots();r.manualContinuousScrolling&&(n>0?i._checkContinuousSwapRight():i._checkContinuousSwapLeft())}}):(t.data("scrollWrapper").scrollLeft(t.data("scrollWrapper").scrollLeft()+n),i._showHideHotSpots(),r.manualContinuousScrolling&&(n>0?i._checkContinuousSwapRight():i._checkContinuousSwapLeft())))},getFlickrContent:function(t,i){var u=this,r=this.element;n.getJSON(t,function(t){function c(t,s){var v=t.media.m,y=v.replace("_m",e[s].letter),p=n("<img />").attr("src",y);p.load(function(){if(this.height<r.data("scrollableAreaHeight")?s+1<e.length?c(t,s+1):l(this):l(this),h===a){switch(i){case"addFirst":r.data("scrollableArea").children(":first").before(f);break;case"addLast":r.data("scrollableArea").children(":last").after(f);break;default:r.data("scrollableArea").html(f)}u.recalculateScrollableArea();u._showHideHotSpots();u._trigger("addedFlickrContent",null,{addedElementIds:o})}})}function l(t){var u=r.data("scrollableAreaHeight")/t.height,e=Math.round(t.width*u),i=n(t).attr("src").split("/"),s=i.length-1;i=i[s].split(".");n(t).attr("id",i[0]);n(t).css({height:r.data("scrollableAreaHeight"),width:e});o.push(i[0]);f.push(t);h++}var e=[{size:"small square",pixels:75,letter:"_s"},{size:"thumbnail",pixels:100,letter:"_t"},{size:"small",pixels:240,letter:"_m"},{size:"medium",pixels:500,letter:""},{size:"medium 640",pixels:640,letter:"_z"},{size:"large",pixels:1024,letter:"_b"}],f=[],o=[],s,a=t.items.length,h=0;s=r.data("scrollableAreaHeight")<=75?0:r.data("scrollableAreaHeight")<=100?1:r.data("scrollableAreaHeight")<=240?2:r.data("scrollableAreaHeight")<=500?3:r.data("scrollableAreaHeight")<=640?4:5;n.each(t.items,function(n,t){c(t,s)})})},getAjaxContent:function(t,i,r){var u=this,f=this.element;n.ajaxSetup({cache:!1});n.get(t,function(e){var o=r!==undefined?r.length>0?n("<div>").html(e).find(r):t:e;switch(i){case"addFirst":f.data("scrollableArea").children(":first").before(o);break;case"addLast":f.data("scrollableArea").children(":last").after(o);break;default:f.data("scrollableArea").html(o)}u.recalculateScrollableArea();u._showHideHotSpots();u._trigger("addedAjaxContent")})},getHtmlContent:function(t,i,r){var u=this,f=this.element,e=r!==undefined?r.length>0?n("<div>").html(t).find(r):t:t;switch(i){case"addFirst":f.data("scrollableArea").children(":first").before(e);break;case"addLast":f.data("scrollableArea").children(":last").after(e);break;default:f.data("scrollableArea").html(e)}u.recalculateScrollableArea();u._showHideHotSpots();u._trigger("addedHtmlContent")},recalculateScrollableArea:function(){var i=0,u=!1,r=this.options,t=this.element;t.data("scrollableArea").children(r.countOnlyClass).each(function(){r.startAtElementId.length>0&&n(this).attr("id")===r.startAtElementId&&(t.data("startingPosition",i),u=!0);i=i+n(this).outerWidth(!0)});u||t.data("startAtElementId","");t.data("scrollableAreaWidth",i);t.data("scrollableArea").width(t.data("scrollableAreaWidth"));t.data("scrollWrapper").scrollLeft(t.data("startingPosition"));t.data("scrollXPos",t.data("startingPosition"))},getScrollerOffset:function(){var n=this.element;return n.data("scrollWrapper").scrollLeft()},stopAutoScrolling:function(){var t=this,n=this.element;n.data("autoScrollingInterval")!==null&&(clearInterval(n.data("autoScrollingInterval")),n.data("autoScrollingInterval",null),t._showHideHotSpots(),t._trigger("autoScrollingStopped"))},startAutoScrolling:function(){var t=this,n=this.element,i=this.options;n.data("enabled")&&(t._showHideHotSpots(),clearInterval(n.data("autoScrollingInterval")),n.data("autoScrollingInterval",null),t._trigger("autoScrollingStarted"),n.data("autoScrollingInterval",setInterval(function(){if(!n.data("visible")||n.data("scrollableAreaWidth")<=n.data("scrollWrapper").innerWidth())clearInterval(n.data("autoScrollingInterval")),n.data("autoScrollingInterval",null);else{n.data("previousScrollLeft",n.data("scrollWrapper").scrollLeft());switch(i.autoScrollingDirection){case"right":n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()+i.autoScrollingStep);n.data("previousScrollLeft")===n.data("scrollWrapper").scrollLeft()&&(t._trigger("autoScrollingRightLimitReached"),clearInterval(n.data("autoScrollingInterval")),n.data("autoScrollingInterval",null),t._trigger("autoScrollingIntervalStopped"));break;case"left":n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()-i.autoScrollingStep);n.data("previousScrollLeft")===n.data("scrollWrapper").scrollLeft()&&(t._trigger("autoScrollingLeftLimitReached"),clearInterval(n.data("autoScrollingInterval")),n.data("autoScrollingInterval",null),t._trigger("autoScrollingIntervalStopped"));break;case"backAndForth":n.data("pingPongDirection")==="right"?n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()+i.autoScrollingStep):n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()-i.autoScrollingStep);n.data("previousScrollLeft")===n.data("scrollWrapper").scrollLeft()&&(n.data("pingPongDirection")==="right"?(n.data("pingPongDirection","left"),t._trigger("autoScrollingRightLimitReached")):(n.data("pingPongDirection","right"),t._trigger("autoScrollingLeftLimitReached")));break;case"endlessLoopRight":n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()+i.autoScrollingStep);t._checkContinuousSwapRight();break;case"endlessLoopLeft":n.data("scrollWrapper").scrollLeft(n.data("scrollWrapper").scrollLeft()-i.autoScrollingStep);t._checkContinuousSwapLeft()}}},i.autoScrollingInterval)))},_checkContinuousSwapRight:function(){var t=this.element,i=this.options,r;t.data("getNextElementWidth")&&(i.startAtElementId.length>0&&t.data("startAtElementHasNotPassed")?(t.data("swapAt",n("#"+i.startAtElementId).outerWidth(!0)),t.data("startAtElementHasNotPassed",!1)):t.data("swapAt",t.data("scrollableArea").children(":first").outerWidth(!0)),t.data("getNextElementWidth",!1));t.data("swapAt")<=t.data("scrollWrapper").scrollLeft()&&(t.data("swappedElement",t.data("scrollableArea").children(":first").detach()),t.data("scrollableArea").append(t.data("swappedElement")),r=t.data("scrollWrapper").scrollLeft(),t.data("scrollWrapper").scrollLeft(r-t.data("swappedElement").outerWidth(!0)),t.data("getNextElementWidth",!0))},_checkContinuousSwapLeft:function(){var t=this.element,i=this.options;t.data("getNextElementWidth")&&(i.startAtElementId.length>0&&t.data("startAtElementHasNotPassed")?(t.data("swapAt",n("#"+i.startAtElementId).outerWidth(!0)),t.data("startAtElementHasNotPassed",!1)):t.data("swapAt",t.data("scrollableArea").children(":first").outerWidth(!0)),t.data("getNextElementWidth",!1));t.data("scrollWrapper").scrollLeft()===0&&(t.data("swappedElement",t.data("scrollableArea").children(":last").detach()),t.data("scrollableArea").prepend(t.data("swappedElement")),t.data("scrollWrapper").scrollLeft(t.data("scrollWrapper").scrollLeft()+t.data("swappedElement").outerWidth(!0)),t.data("getNextElementWidth",!0))},restoreOriginalElements:function(){var n=this,t=this.element;t.data("scrollableArea").html(t.data("originalElements"));n.recalculateScrollableArea();n.jumpToElement("first")},show:function(){var n=this.element;n.data("visible",!0);n.show()},hide:function(){var n=this.element;n.data("visible",!1);n.hide()},enable:function(){var n=this.element;this.options.touchScrolling&&n.data("scrollWrapper").kinetic("attach");n.data("enabled",!0)},disable:function(){var t=this,n=this.element;t.stopAutoScrolling();clearInterval(n.data("rightScrollingInterval"));clearInterval(n.data("leftScrollingInterval"));clearInterval(n.data("hideHotSpotBackgroundsInterval"));this.options.touchScrolling&&n.data("scrollWrapper").kinetic("detach");n.data("enabled",!1)},destroy:function(){var i=this,t=this.element;i.stopAutoScrolling();clearInterval(t.data("rightScrollingInterval"));clearInterval(t.data("leftScrollingInterval"));clearInterval(t.data("hideHotSpotBackgroundsInterval"));t.data("scrollingHotSpotRight").unbind("mouseover");t.data("scrollingHotSpotRight").unbind("mouseout");t.data("scrollingHotSpotRight").unbind("mousedown");t.data("scrollingHotSpotLeft").unbind("mouseover");t.data("scrollingHotSpotLeft").unbind("mouseout");t.data("scrollingHotSpotLeft").unbind("mousedown");t.unbind("mousenter");t.unbind("mouseleave");t.data("scrollingHotSpotRight").remove();t.data("scrollingHotSpotLeft").remove();t.data("scrollableArea").remove();t.data("scrollWrapper").remove();t.html(t.data("originalElements"));n.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery),function(n){"use strict";var c={cursor:"move",decelerate:!0,triggerHardware:!1,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},t="kinetic-settings",i="kinetic-active";window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}());n.support=n.support||{};n.extend(n.support,{touch:"ontouchend"in document});var u=function(){return!1},f=function(n,t){return Math.floor(Math.abs(n))===0?0:n*t},e=function(n,t){var i=n;return n>0?n>t&&(i=t):n<0-t&&(i=0-t),i},o=function(n,t){this.removeClass(n.movingClass.up).removeClass(n.movingClass.down).removeClass(n.movingClass.left).removeClass(n.movingClass.right).removeClass(n.deceleratingClass.up).removeClass(n.deceleratingClass.down).removeClass(n.deceleratingClass.left).removeClass(n.deceleratingClass.right);n.velocity>0&&this.addClass(t.right);n.velocity<0&&this.addClass(t.left);n.velocityY>0&&this.addClass(t.down);n.velocityY<0&&this.addClass(t.up)},s=function(n,t){t.velocity=0;t.velocityY=0;t.decelerate=!0;typeof t.stopped=="function"&&t.stopped.call(n,t)},r=function(n,t){var i=n[0];t.x&&i.scrollWidth>0?(i.scrollLeft=t.scrollLeft=i.scrollLeft+t.velocity,Math.abs(t.velocity)>0&&(t.velocity=t.decelerate?f(t.velocity,t.slowdown):t.velocity)):t.velocity=0;t.y&&i.scrollHeight>0?(i.scrollTop=t.scrollTop=i.scrollTop+t.velocityY,Math.abs(t.velocityY)>0&&(t.velocityY=t.decelerate?f(t.velocityY,t.slowdown):t.velocityY)):t.velocityY=0;o.call(n,t,t.deceleratingClass);typeof t.moved=="function"&&t.moved.call(n,t);Math.abs(t.velocity)>0||Math.abs(t.velocityY)>0?window.requestAnimationFrame(function(){r(n,t)}):s(n,t)},l=function(i){var r=n.kinetic.callMethods[i],u=Array.prototype.slice.call(arguments);r&&this.each(function(){var i=u.slice(1),f=n(this).data(t);i.unshift(f);r.apply(this,i)})},h=function(t,i){var r=t[0];n.support.touch?t.bind("touchstart",i.events.touchStart).bind("touchend",i.events.inputEnd).bind("touchmove",i.events.touchMove):t.mousedown(i.events.inputDown).mouseup(i.events.inputEnd).mousemove(i.events.inputMove);t.click(i.events.inputClick).scroll(i.events.scroll).bind("selectstart",u).bind("dragstart",i.events.dragStart)},a=function(t,i){var r=t[0];n.support.touch?t.unbind("touchstart",i.events.touchStart).unbind("touchend",i.events.inputEnd).unbind("touchmove",i.events.touchMove):t.unbind("mousedown",i.events.inputDown).unbind("mouseup",i.events.inputEnd).unbind("mousemove",i.events.inputMove).unbind("scroll",i.events.scroll);t.unbind("click",i.events.inputClick).unbind("selectstart",u);t.unbind("dragstart",i.events.dragStart)},v=function(u){this.addClass(i).each(function(){var tt=this,f=n(this),b;if(!f.data(t)){var i=n.extend({},c,u),s,y=!1,l,p=!1,a=!1,it=1e3/i.throttleFPS,w,v;i.velocity=0;i.velocityY=0;b=function(){s=!1;l=!1;a=!1};n(document).mouseup(b).click(b);var k=function(){i.velocity=e(y-s,i.maxvelocity);i.velocityY=e(p-l,i.maxvelocity)},d=function(t,r){return n.isFunction(i.filterTarget)?i.filterTarget.call(tt,t,r)!==!1:r.which&&r.which>1?!1:!0},g=function(n,t){a=!0;i.velocity=y=0;i.velocityY=p=0;s=n;l=t},rt=function(){s&&y&&i.decelerate===!1&&(i.decelerate=!0,k(),s=y=a=!1,r(f,i))},nt=function(t,r){(!w||new Date>new Date(w.getTime()+it))&&(w=new Date,a&&(s||l)&&(v&&(n(v).blur(),v=null,f.focus()),i.decelerate=!1,i.velocity=i.velocityY=0,f[0].scrollLeft=i.scrollLeft=i.x?f[0].scrollLeft-(t-s):f[0].scrollLeft,f[0].scrollTop=i.scrollTop=i.y?f[0].scrollTop-(r-l):f[0].scrollTop,y=s,p=l,s=t,l=r,k(),o.call(f,i,i.movingClass),typeof i.moved=="function"&&i.moved.call(f,i)))};i.events={touchStart:function(n){var t;d(n.target,n)&&(t=n.originalEvent.touches[0],g(t.clientX,t.clientY),n.stopPropagation())},touchMove:function(n){var t;a&&(t=n.originalEvent.touches[0],nt(t.clientX,t.clientY),n.preventDefault&&n.preventDefault())},inputDown:function(n){d(n.target,n)&&(g(n.clientX,n.clientY),v=n.target,n.target.nodeName==="IMG"&&n.preventDefault(),n.stopPropagation())},inputEnd:function(){rt();v=null},inputMove:function(n){a&&(nt(n.clientX,n.clientY),n.preventDefault&&n.preventDefault())},scroll:function(n){typeof i.moved=="function"&&i.moved.call(f,i);n.preventDefault&&n.preventDefault()},inputClick:function(n){if(Math.abs(i.velocity)>0)return n.preventDefault(),!1},dragStart:function(){if(v)return!1}};h(f,i);f.data(t,i).css("cursor",i.cursor);i.triggerHardware&&f.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})}})};n.kinetic={settingsKey:t,callMethods:{start:function(t,i){var u=n(this);t=n.extend(t,i);t&&(t.decelerate=!1,r(u,t))},end:function(t){var i=n(this);t&&(t.decelerate=!0)},stop:function(t){var i=n(this);s(i,t)},detach:function(t){var r=n(this);a(r,t);r.removeClass(i).css("cursor","")},attach:function(t){var r=n(this);h(r,t);r.addClass(i).css("cursor","move")}}};n.fn.kinetic=function(n){return typeof n=="string"?l.apply(this,arguments):v.call(this,n),this}}(window.jQuery||window.Zepto);var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pages;(function(n){var t;(function(t){var i=function(t){function i(n,i,r,u,f,e,o,s){var h=t.call(this,n,i)||this;return h.calculatorLoaded=!1,h.localLogicLoaded=!1,h.sliderLoaded=!1,h.mousedownOccured=!1,h.mouseIsDragging=!1,h.currentMouseMoveCord="",h.isDemographicsLoaded=!1,h.videoSliderInitialized=!1,h.DisplayPeriodValues=!0,h.ShowLatestOffers=!1,h.triggeredClosingNewPublicOffersMsg=!1,h.AcceptedBuyer="",h.pageNotVisibleWhenOffersToBeRefresh=!1,h.PeriodOfferStatusID=u,h.DisplayPeriodValues=f==="True"?!0:!1,h.OffersCount=r,h.ShowLatestOffers=e==="True"?!0:!1,h.AcceptedOfferIndex=o,h.AcceptedBuyer=s,h.init(),h}return __extends(i,t),i.prototype.loadModel=function(n){this.Model=n},i.prototype.render=function(){var n=this,t,r,u,i;(n.PeriodOfferStatusID==4||n.PeriodOfferStatusID==5)&&$("#offersTimelinegrid tr:nth-child("+n.AcceptedOfferIndex+")").addClass("highlightRow");n.ShowLatestOffers&&(ApplicationConfig.EnableListingPublicOfferRefresh&&n.setRefreshPublicOffersInterval(),n.initNewNotificationPublicOfferMsg(),n.loadOpenOfferInfoIconTooltip());(n.Model.listingId||"")!=""&&Analytics.log(n.Model.listingId,"view",n.Model.hasOpenHouse);RecentlyViewedListing.save(n.model.listingId);Favourite.refreshIcons($("#listingActionIconsCon"),{animInFavClass:"listingCardHeaderFavourited",animOutFavClass:"listingCardHeaderUnFavourited"});Note.refreshIcons($("#listingActionIconsCon"),!0);Currency.refreshListingPrice(null);Currency.refreshPublicOfferPrices();Currency.refreshCADLabels();$("#listingPhotoCarousel").smoothDivScroll({mousewheelScrolling:!0,visibleHotSpotBackgrounds:"always",hotSpotScrollingInterval:7,hotSpotScrollingStep:9,hotSpotMouseDownSpeedBooster:4,touchScrolling:!0});n.checkForEmailTrigger();n.showNotifications(n.model.listingId);n.checkPartnerIds();Controls.Desktop.TabHighlighter.insert($(".listingDetailsTabsIconCon:visible"),function(){n.updateTabView()});window.addEventListener("load",function(){n.showSimilarListings(n);n.setMeasurementUnits()});Utilities.loadScript("/Scripts/royal-slider-9.5.7.min.js",null,!0);n.model.multimedia!=null&&n.model.multimedia.length>0&&(t=[],t.push(n.Model.multimedia[0]),n.Model.multimedia.length>1&&t.push(n.Model.multimedia[1]),n.Model.multimedia.length>2&&t.push(n.Model.multimedia[n.Model.multimedia.length-1]),t.forEach(function(n,i){n.AjaxVideoDataQueueName=MultimediaModel.AjaxVideoDataQueueBaseName+"_first+adjacent";t[i].StartEmbed()}),r=function(n,t,i){return t!=i.length-1&&t>1},i=n.Model.multimedia.filter(r),i.forEach(function(n,t){t%2==0&&(u=MultimediaModel.AjaxVideoDataQueueBaseName+"_"+t);i[t].AjaxVideoDataQueueName=u}),n.videoSlider=new Swiper("#swiper-videos",{threshold:10,pagination:{el:"#swiper-videos-pagination",dynamicBullets:!0,clickable:!0},navigation:{nextEl:"#swiper-videos-button-container-next",prevEl:"#swiper-videos-button-container-prev"},loop:!0,slidesPerView:1,spaceBetween:25,on:{init:function(t){n.videoSliderInitialized=!0;$("#swiper-videos #swiper-videos-navigator").css("visibility","visible");n.model.multimedia.length==1&&($("#swiper-videos #swiper-videos-navigator .swiper-button-next,#swiper-videos #swiper-videos-navigator .swiper-button-prev").addClass("swiper-button-disabled"),t.allowSlideNext=!1,t.allowSlidePrev=!1,t.allowTouchMove=!1);t.update()},click:function(){},transitionStart:function(){},slidePrevTransitionStart:function(t){if(n.videoSliderInitialized){var i=Utilities.getSwiperjsRealIndex(t);i<n.Model.multimedia.length&&i>=0&&!n.Model.multimedia[i].videoLoading&&!n.Model.multimedia[i].videoLoaded&&n.Model.multimedia[i].StartEmbed();i-1<n.Model.multimedia.length&&i-1>=0&&!n.Model.multimedia[i-1].videoLoading&&!n.Model.multimedia[i-1].videoLoaded&&n.Model.multimedia[i-1].StartEmbed()}},slideNextTransitionStart:function(t){if(n.videoSliderInitialized){var i=Utilities.getSwiperjsRealIndex(t);i<n.Model.multimedia.length&&i>=0&&!n.Model.multimedia[i].videoLoading&&!n.Model.multimedia[i].videoLoaded&&n.Model.multimedia[i].StartEmbed();i+1<n.Model.multimedia.length&&i+1>=0&&!n.Model.multimedia[i+1].videoLoading&&!n.Model.multimedia[i+1].videoLoaded&&n.Model.multimedia[i+1].StartEmbed()}},slidePrevTransitionEnd:function(t){n.videoSliderInitialized&&(n.setFloorPlanIcon(n.Model.floorPlanIcon,n.getActiveSwiperVirtualVideo(t)),n.videoSliderFsCallBack(n,t.previousIndex-1))},slideNextTransitionEnd:function(t){n.videoSliderInitialized&&(n.setFloorPlanIcon(n.Model.floorPlanIcon,n.getActiveSwiperVirtualVideo(t)),n.videoSliderFsCallBack(n,t.previousIndex-1))}}}));Utilities.removeQueryParamsAndReplaceCurrentURL(["mapview","SavedSearchName","euid","nid","utm_source","utm_medium","utm_campaign","utm_content"])},i.prototype.setRefreshPublicOffersInterval=function(){var n=this;n.refreshPublicOffersInterval=setInterval(function(){Utilities.isPageContentVisible()?n.refreshPublicOffers():n.pageNotVisibleWhenOffersToBeRefresh=!0},ApplicationConfig.ListingPublicOfferRefreshRateMS)},i.prototype.refreshPublicOffers=function(){var n=this,t={ListingID:n.Model.listingId,ApplicationId:"1",SortBy:"2",SortOrder:"D",Currency:ApplicationState.CurrencyValue,CultureId:ApplicationState.CultureID.toString()};LatestOffersModel.GetLatestPublicOffers(t,function(t){n.loadOfferResults(t)},function(n,t,i){Logging.Error("An issue with getting latestpublic offers: ".concat(i))})},i.prototype.showSimilarListings=function(n,t){if($("#similarListingsCon").length>0||t){var i=new ControlFetcherArgs("","similarListingsCon",function(n){$(n).find(".listingDetailsLink").length>0?($("#similarListingsOuterCon").show(),$("#similarListingsCon").html(n)):$("#similarListingsOuterCon").hide();$("#similarListingsOuterCon").css("min-height","")});i.showLoadingAnimation=!1;i.errorHandler=function(){$("#similarListingsOuterCon").hide()};i.refreshIconAnimInOutPref={animInFavClass:"listingCardHeaderFavourited",animOutFavClass:"listingCardHeaderUnFavourited"};ControlFetcher.fetchSimilarListingsCarousel(i,{listingIds:[n.Model.listingId]})}},i.prototype.checkForEmailTrigger=function(){var n=Utilities.getParamValueByName("EmailRealtor",URLParamType.Query),t=Utilities.getParamValueByName("EmailOffice",URLParamType.Query);n!=""?LoadEmailRealtorForm(n,this.Model.listingId,this.Model.referenceNumber):t!=""&&LoadEmailOfficeForm(t,this.Model.listingId,this.Model.referenceNumber)},i.prototype.LoadConsumerData=function(n){var t=new GetAccountFromBOLCallbackArgs;t.page=n;t.functionCalls=function(){Favourite.refreshIcons($("#listingActionIconsCon"),{animInFavClass:"listingCardHeaderFavourited",animOutFavClass:"listingCardHeaderUnFavourited"});Note.refreshIcons($("#listingActionIconsCon"),!0)};GigyaInit.GetAccountFromBOL(ApplicationConfig.GigyaSyncRealTime,!1,t)},i.prototype.videoSliderFsCallBack=function(n,t){t===void 0&&(t=-1);var i=t>-1?t:Utilities.getSwiperjsRealIndex(n.videoSlider);n.videoSlider!=null&&i>=0&&i<n.Model.multimedia.length&&(n.Model.multimedia[i].emptyVideoContainer(),n.Model.multimedia[i].showVideoIframe(!1),n.Model.multimedia[i].showLoadingVideoContainer(!1),n.Model.multimedia[i].showVideoThumbnail())},i.prototype.getActiveSwiperVirtualVideo=function(n){var i,t=Utilities.getSwiperjsRealIndex(n);return n!=null&&((i=this.Model)===null||i===void 0?void 0:i.multimedia)?t==this.Model.multimedia.length?this.Model.multimedia[0]:t<0?this.Model.multimedia[this.Model.multimedia.length-1]:this.Model.multimedia[t>0&&t<this.Model.multimedia.length?t:0]:null},i.prototype.swiperEnterFullscreen=function(n,t){n.hasClass("swiperFullscreen")||($("#listingDetailsContactStripCon").toggleClass("hide",!0),n.css("opacity",0),$("header").css("pointer-events","none"),n.addClass("swiperFullscreen"),$("body,html").addClass("fsNoScroll"),Utilities.queueTask(function(){t.update();n.css("opacity",1)}))},i.prototype.swiperExitFullScreen=function(n,t,i){i===void 0&&(i=null);n.hasClass("swiperFullscreen")&&($("#listingDetailsContactStripCon").toggleClass("hide",!0),i!=null?i(this):null,n.css("opacity",0),n.removeClass("swiperFullscreen"),$("body,html").removeClass("fsNoScroll"),$("header").css("pointer-events",""),Utilities.queueTask(function(){t.update();n.css("opacity",1)}))},i.prototype.registerEventHandlers=function(){var i=this,t=this;$(document).on("click",function(n){t.triggeredClosingNewPublicOffersMsg=!$(n.target).hasClass("calloutCloseBtn")&&$(n.target).parents(".calloutCloseBtn").length<=0&&!$(n.target).hasClass("calloutBtn")&&$(n.target).parents(".calloutBtn").length<=0?!1:!0});$(document).on("click",".close-swiper-btn",function(){t.swiperExitFullScreen($("#swiper-videos"),t.videoSlider,t.videoSliderFsCallBack)});$(window).resize(function(){$("#tableHistoryDetail tbody tr").length>ApplicationConfig.MaxSoldDataDisplay?($("#historyDetailSection").show(),$("#historyDetailSection").find("td").each(function(n,t){breakAllLongWords($(t))}),collapseTableWithReadMore($("#historyDetailSectioniInner"),$("#tableHistoryDetail"),ApplicationConfig.MaxSoldDataDisplay+1,"text-align: right;")):$("#historyDetailSection").show()});GigyaInit.Events.consumerLoggedIn.Listen(function(){ApplicationState.UserIsSignedIn&&(i.LoadConsumerData(t),$("#listingNotesIconCon").show(),Note.exists(t.model.listingId)&&$("#listingNotesText").text(Translation.get("EditNotes")))});MultimediaModel.virtualTourLoadEvent.Listen(function(){});MultimediaModel.virtualTourAddVideoEvent.Listen(function(n){var i=$("."+t.videoSlider.params.slideActiveClass);$(n.detail.iframeHtmlToAppend).appendTo(i.find("#"+n.detail.model.VideoInnerContainerId));t.swiperEnterFullscreen($("#swiper-videos"),t.videoSlider);Analytics.log(t.Model.listingId,"virtual-videos")});MultimediaModel.virtualTourDataFetched.Listen(function(){t.setFloorPlanIcon(t.Model.floorPlanIcon,t.getActiveSwiperVirtualVideo(t.videoSlider))});GigyaInit.Events.consumerLoggedOut.Listen(function(){$("#listingNotesIconCon").hide();$("#listingNotesText").text(Translation.get("AddNotes"))});Note.noteRemovedEvent.Listen(function(n){t.model.listingId==n.detail.id&&$("#listingNotesText").text(Translation.get("AddNotes"))});Note.noteAddedEvent.Listen(function(n){t.model.listingId==n.detail.id&&$("#listingNotesText").text(Translation.get("EditNotes"))});$(".liveStreamConLink").click(function(){Analytics.log(t.model.listingId,AnalyticsValues.livestream_join)});$("#listingActionIconsCon .noteIcon").click(function(){return noteIconClicked($(this),!0),!1});$("#chkMeasurements").change(function(){$(this).is(":checked")?t.switchMeasurementsToImperial():t.switchMeasurementsToMetric()});$("#lnkViewStatistics").click(function(){URLHash.setWithNoBackButton("view","stats")});$("#lnkViewCalc").click(function(){URLHash.setWithNoBackButton("view","calc")});$(".listingDetailsTabsIconCon").click(function(){$(".listingTabContent").hide();$(".listingDetailsTabsIconCon").removeClass("selected");$(this).addClass("selected")});$("#listingPrintBtn").click(function(){Note.showPrintNoteSection(t.Model.listingId,$("#propertyDetailsNotePrintCon"));window.print()});$("#lnkViewNeighbourhood").mousedown(function(){t.loadNeighbourhoodWidget()});$("#nextEventLiveTextCon").length>0&&$("#nextEventHeaderCon").click(function(){ScrollToElement($("#LiveStreams"))});$("#lnkViewNeighbourhood").click(function(){t.loadNeighbourhoodWidget();$("#listingNeighbourhoodTab").show();URLHash.setWithNoBackButton("view","neighbourhood")});$("#lnkViewListingInfo").click(function(){var n;$("#listingInfoTab").show();(n=t.videoSlider)===null||n===void 0?void 0:n.update();URLHash.removeHash(!1)});$("#showAllLiveStreamsLnk").length>0&&$("#showAllLiveStreamsLnk").click(function(){return $(".liveStreamCon").removeClass("hide"),$(this).remove(),!1});$("#showAllOpenHousesLnk").length>0&&$("#showAllOpenHousesLnk").click(function(){return $(".openHouseCon").removeClass("hide"),$(this).remove(),!1});$("#lnkViewStatistics").length>0&&$("#lnkViewStatistics").click(function(){var i=function(){(t.isDemographicsLoaded||!1)==!1&&t.LoadDemographics()};t.loadGoogleMaps(ApplicationConfig.GoogleAPIKey,i);$("#listingStatisticsTab").show();Events.Fire(n.Desktop.Listing.ViewingStatistics,t)});$("#lnkViewCalc").length>0&&$("#lnkViewCalc").click(function(){$("#listingCalculatorsTab").show();t.loadCalculator()});$("#listingPhotoCarousel a").bind("touchstart mousedown",function(){t.mousedownOccured=!0;$(window).bind("mousemove touchmove",function(n){var i=n.screenX+" "+n.screenY;t.currentMouseMoveCord!=i&&t.currentMouseMoveCord!=""&&(t.mouseIsDragging=!0);t.currentMouseMoveCord=i})});$("#listingPhotoCarousel a").bind("touchend mouseup",function(){var n,i;t.currentMouseMoveCord="";n=t.mouseIsDragging;t.mouseIsDragging=!1;$(window).unbind("mousemove touchmove");i=Number($(this).attr("id").split("_")[1]);!n&&t.mousedownOccured&&t.launchImageGal2(i);t.mousedownOccured=!1});$("#listingPhotoCarousel a").click(function(n){n.preventDefault()});GigyaInit.Events.consumerMeasurementsLoaded.Listen(function(){t.setMeasurementUnits()});$("#tableHistoryDetail tbody tr").length>ApplicationConfig.MaxSoldDataDisplay?($("#historyDetailSection").show(),$("#historyDetailSection").find("td").each(function(n,t){breakAllLongWords($(t))}),collapseTableWithReadMore($("#historyDetailSectioniInner"),$("#tableHistoryDetail"),ApplicationConfig.MaxSoldDataDisplay+1,"text-align: right;")):$("#historyDetailSection").show();Events.Listen(Controls.Desktop.CurrencyCtrl.currencyUpdated,function(n){var i=n.detail;Currency.refreshListingPrice(null);Currency.refreshPublicOfferPrices();Currency.refreshCADLabels();t.showSimilarListings(t,!0)});$("#propertyDetailsOpenHouseAddToCalendar").click(function(){t.addOpenHouseToCalendar()});$("#propertyDetailsLiveStreamAddToCalendar").click(function(){t.addLiveStreamToCalendar()});$("#nextEventLiveTextCon").length>0&&$(".listingDetailsHeaderNextEventCon").click(function(){ScrollToElement($("#LiveStreams"))});$("#listingDirectionsBtn").click(function(){Analytics.log(t.model.listingId,"driving")});$("#viewAllPublicOffers > a").click(function(){return ScrollToElement($("#listingDetailsOffersCon")),!1});document.addEventListener("visibilitychange",function(){t.pageNotVisibleWhenOffersToBeRefresh&&(clearInterval(t.refreshPublicOffersInterval),t.refreshPublicOffers(),t.pageNotVisibleWhenOffersToBeRefresh=!1,t.setRefreshPublicOffersInterval())})},i.prototype.addOpenHouseToCalendar=function(){var n=this;addOpenHouseToCalendar(n.model.listingId,n.model.referenceNumber)},i.prototype.addLiveStreamToCalendar=function(){var n=this;addLiveStreamToCalendar(n.Model.listingId,n.Model.referenceNumber)},i.prototype.loadOpenOfferInfoIconTooltip=function(){var n=this,u,r;if(n.PeriodOfferStatusID){var t="",i="";(n.PeriodOfferStatusID==4||n.PeriodOfferStatusID==5)&&(t=Translation.get("OfferAccepted"),i=Translation.get("OfferAcceptedID",n.AcceptedBuyer));(n.PeriodOfferStatusID==3||n.PeriodOfferStatusID==8)&&(t=Translation.get("ReviewingOffers"),i=Translation.get("ReviewingOfferswithOffers"));(n.PeriodOfferStatusID==1||n.PeriodOfferStatusID==2)&&(t=Translation.get("AcceptingNewOffers"),i=n.OffersCount>0?Translation.get("AcceptingOfferswithOffers"):Translation.get("AcceptingOfferswithNoOffers"));u={SecondaryTextContent:"",MainTextContent:i,TitleText:t};r=new ControlFetcherArgs;r.postCallHandler=function(n){$("#AcceptingOffersIcon").qtip({content:n.d})};ControlFetcher.fetchLatestOffersToolTipInfo(r,u)}},i.prototype.loadCalculator=function(){var i=this,n,r,u,t;i.calculatorLoaded==!1&&(n=$("#CalciFrame"),$("#CalciFrame").show(),n.attr("src",n.data("src")),r=function(n){window.setTimeout(function(){$("#CalcLoadingCon").hide()},500);n.data=="PaymentCalcLoaded"?$("#CalciFrame").show():n.data=="PaymentCalcWidgetError"&&$("#CalciFrame").text("Loading Error")},window.addEventListener("message",r,!1),document.getElementById("iframeResizeScript")?u=iFrameResize({log:!1,checkOrigin:!1},"#CalciFrame"):(t=Utilities.createScriptTag("/scripts/iframeResizer.min.js","iframeResizeScript"),t.onload=function(){u=iFrameResize({log:!1,checkOrigin:!1,heightCalculationMethod:"taggedElement"},"#CalciFrame")},document.head.appendChild(t)),i.calculatorLoaded=!0)},i.prototype.updateTabView=function(){var n=URLHash.get("view","").toLowerCase();switch(n){case"":$("#lnkViewListingInfo").click();break;case"neighbourhood":$("#lnkViewNeighbourhood").click();break;case"stats":$("#lnkViewStatistics").click();break;case"calc":$("#lnkViewCalc").click();break;default:$(".listingDetailsTabsIconCon:visible")[0].click()}},i.prototype.SetupDemographicsAccordian=function(){var n=$("#DemographicsChartsCon").show().accordion({active:!1,collapsible:!0,header:".DemographicsChartTitleCon",autoHeight:!0,animate:!1,heightStyle:"content",change:function(n,t){var i=t}}).on("click",function(){n.not(this).accordion("activate",!1);var t=this;$(this).find(".DemographicsChartOuterCon").removeClass("show");window.setTimeout(function(){$(t).find(".ui-accordion-header-active").parent().find(".DemographicsChartOuterCon").addClass("show")},100)})},i.prototype.loadGoogleMaps=function(n,t){if(console.log("Module Loaded: Google Maps"),Utilities.isGoogleMapsDefined()==!1){var u=document.getElementsByTagName("script")[0],i=document.createElement("script"),r="";ApplicationConfig.IsQAMode&&(r="&v=3");i.id="googleMapsAPI";t&&(i.onload=function(){t()});ApplicationState.CultureID==1?i.setAttribute("src","//maps.googleapis.com/maps/api/js?callback=GoogleMapsLoaded&key="+n+"&region=CA&language=en&libraries=places"+r):i.setAttribute("src","//maps.googleapis.com/maps/api/js?callback=GoogleMapsLoaded&key="+n+"&region=CA&language=fr&libraries=places"+r);u.parentNode.insertBefore(i,u)}else t&&t()},i.prototype.setMeasurementUnits=function(){var n=Cookie.PreferredMeasurementUnits.get(MeasurementUnits.Imperial.toString());$("#chkMeasurements").length==0&&this.switchMeasurementsToImperial();n==MeasurementUnits.Imperial.toString()?this.switchMeasurementsToImperial():n==MeasurementUnits.Metric.toString()&&this.switchMeasurementsToMetric()},i.prototype.setFloorPlanIcon=function(n,t){var i,r,u,f;!(t===null||t===void 0?void 0:t.videoDataFetched)||!((i=t.SelectedHost)===null||i===void 0?void 0:i.FormatedPdfUrlFeet)||!((r=t.SelectedHost)===null||r===void 0?void 0:r.FormatedPdfUrlMetric)?(t===null||t===void 0?void 0:t.showFloorPlanIcon(!1))||(n.remove(),n.length>0&&$("#listingDetailsStripIcons").find(".listingDetailsIconStripCon").length==0?$("#listingDetailsIconStrip").hide():null):(n.css("display","inline-block"),u="",f=Cookie.PreferredMeasurementUnits.get(MeasurementUnits.Imperial.toString())==MeasurementUnits.Imperial.toString(),u=f?f?t.SelectedHost.FormatedPdfUrlFeet:t.SelectedHost.FormatedPdfUrlMetric:t.SelectedHost.FormatedPdfUrlMetric,n.attr("href",u),n.appendTo("#listingDetailsStripIcons"),n.length>0&&$("#listingDetailsStripIcons").find(".listingDetailsIconStripCon").length==1?$("#listingDetailsIconStrip").show():null)},i.prototype.switchMeasurementsToMetric=function(){$("#chkMeasurements").prop("checked",!1);Cookie.PreferredMeasurementUnits.get("")!=MeasurementUnits.Metric.toString()&&Cookie.PreferredMeasurementUnits.save(MeasurementUnits.Metric.toString());this.setFloorPlanIcon(this.Model.floorPlanIcon,this.getActiveSwiperVirtualVideo(this.videoSlider));$("#lnkFeetToogle").removeClass("toggleActive");$("#lnkMetersToggle").addClass("toggleActive");$(".Imperial").hide();$(".Metric").css("display","")},i.prototype.switchMeasurementsToImperial=function(){$("#chkMeasurements").prop("checked",!0);Cookie.PreferredMeasurementUnits.get("")!=MeasurementUnits.Imperial.toString()&&Cookie.PreferredMeasurementUnits.save(MeasurementUnits.Imperial.toString());this.setFloorPlanIcon(this.Model.floorPlanIcon,this.getActiveSwiperVirtualVideo(this.videoSlider));$("#lnkMetersToggle").removeClass("toggleActive");$("#lnkFeetToogle").addClass("toggleActive");$(".Imperial").css("display","");$(".Metric").hide()},i.prototype.loadNeighbourhoodWidget=function(){var t,i,n;($("#NeighbourhoodiFrame").attr("loaded")||"")==""&&(t=$("#NeighbourhoodiFrame")[0],t.contentWindow.location.replace($("#NeighbourhoodiFrame").attr("data-src")),$("#NeighbourhoodiFrame").attr("loaded","true"),$("#NeighbourhoodiFrame").css("min-height",""),document.getElementById("iframeResizeScript")?i=iFrameResize({log:!1,checkOrigin:!1,heightCalculationMethod:"taggedElement"},"#NeighbourhoodiFrame"):(n=Utilities.createScriptTag("/scripts/iframeResizer.min.js","iframeResizeScript"),n.onload=function(){i=iFrameResize({log:!1,checkOrigin:!1,heightCalculationMethod:"taggedElement"},"#NeighbourhoodiFrame")},document.head.appendChild(n)),$("#NeighbourhoodiFrame").css("display","block"))},i.prototype.LoadDemographics=function(){var n=this,i,t;n.isDemographicsLoaded=!0;$("#listingDemographicsCon").length>0&&(i=new ControlFetcherArgs("ListingDetailsDemographicsWrapperCon","listingDemographicsCon"),i.showLoadingAnimation=!1,i.showLoadingSpinner=!0,i.postCallHandler=function(){n.SetupDemographicsAccordian()},t=new DemographicsArgs,t.Latitude=n.Model.latitude,t.Longitude=n.Model.longitude,t.PropertyTypeId=n.Model.propertyTypeId,t.ProvinceCode=n.Model.provinceCode,t.DisseminationArea=n.Model.disseminationArea,ControlFetcher.fetchDemographics(i,t))},i.prototype.cssFullscreenReset=function(){$("body").css("overflow","");$("body").css("height","");$("body").css("width","");$("body").css("overflow","");$("html").css("overflow","");$("html").css("height","");$("html").css("width","");$("html").css("overflow","")},i.prototype.handleTranslateObj=function(n){var r,t,i;try{r=$(".rsVideoContainer");typeof n!="undefined"&&n.holder&&n.holder.length>0&&(t=Number(n.holder[0].style.left.replace("px","")),t=t*-1,i="translate("+t+"px,0)",$(".rsContainer").css("transform",i))}catch(u){console.log(u)}},i.prototype.launchImageGal2=function(n){var t=this;(t.Model.listingId||"")!=""&&Analytics.log(t.Model.listingId,"photo");$("#pnlImageCarousel").lightbox_me({centered:!0,onLoad:function(){t.sliderLoaded!=!0?($("#royalslider-def").royalSlider({startSlideId:parseInt(n)-1,controlNavigation:"thumbnails",imageAlignCenter:!1,arrowsNav:!0,transitionType:"move",imageScaleMode:"none",keyboardNavEnabled:!0,transitionSpeed:100,fadeinLoadedSlide:!1,globalCaption:!0,navigateByClick:!1,fullscreen:{enabled:!0,nativeFS:!0}}),$(".rsThumbs").insertAfter(".rsGCaption"),$(window).trigger("resize"),t.sliderLoaded=!0):($("#royalslider-def").data("royalSlider").goTo(parseInt(n)-1),$(window).trigger("resize"))}})},i.prototype.showNotifications=function(n){Favourite.exists(n)&&ConsumerProfile.UserAccountSettings.FavNotificationsEnabled&&$("#propertyNotificationsCon").show()},i.prototype.checkPartnerIds=function(){var n="tdcust",t=Utilities.getParamValueByName(n,URLParamType.Query);t!=null&&t!=""&&Utilities.removeQueryViaState(n)},i.prototype.loadOfferResults=function(n){var f,e,o,s,h,c,l,a,v,y,t=this,p,i,u,r;if(!n){$("#AcceptingOffersTimeline").addClass("hide");return}p=(((f=n===null||n===void 0?void 0:n.PublicOfferPeriod)===null||f===void 0?void 0:f.StatusId)||0)!=0;p?$("#AcceptingOffersTimeline").removeClass("hide"):$("#AcceptingOffersTimeline").addClass("hide");t.OffersCount=(o=(e=n.PublicOffers)===null||e===void 0?void 0:e.length)!==null&&o!==void 0?o:0;t.DisplayPeriodValues=(h=(s=n.PublicOfferPeriod)===null||s===void 0?void 0:s.DisplayValues)!==null&&h!==void 0?h:!1;t.PeriodOfferStatusID=(l=(c=n.PublicOfferPeriod)===null||c===void 0?void 0:c.StatusId)!==null&&l!==void 0?l:0;$("#totalCreatedOffers").text(t.OffersCount.toString());$("#publicOfferOfferTitle").text(t.OffersCount>1?Translation.get("Offers"):Translation.get("Offer"));i=(a=n.PublicOffers)===null||a===void 0?void 0:a.filter(function(t){return t.SourceOfferKey==n.PublicOfferPeriod.AcceptedSourceOfferKey});u=(v=n.PublicOffers)===null||v===void 0?void 0:v.sort(function(n,t){return n.Price<t.Price?1:-1})[0];n.PublicOffers=(y=n.PublicOffers)===null||y===void 0?void 0:y.sort(function(n,t){return Number(new Date(t.TimestampUTC))-Number(new Date(n.TimestampUTC)||Number(new Date(t.InsertedDate))-Number(new Date(n.InsertedDate)))});t.DisplayPeriodValues?($("#HighestOrAcceptedtag").removeClass("hide"),r=ApplicationState.CultureID==Language.English?": ":" : ",(t.PeriodOfferStatusID==4||t.PeriodOfferStatusID==5)&&(i===null||i===void 0?void 0:i.length)>0?($("#HighestOrAcceptedOffertxt").text(Translation.get("AcceptedOffer")+r),$("#HighestOrAccpetedPrice").text(LatestOffersModel.GetCurrencyOfferPriceFormatted(i[0],ApplicationState.CurrencyValue))):!u||($("#HighestOrAcceptedOffertxt").text(Translation.get("HighestOffer")+r),$("#HighestOrAccpetedPrice").text(LatestOffersModel.GetCurrencyOfferPriceFormatted(u,ApplicationState.CurrencyValue)))):$("#HighestOrAcceptedtag").addClass("hide");t.OffersCount>0||!t.DisplayPeriodValues||($("#HighestOrAcceptedtag").removeClass("hide"),r=ApplicationState.CultureID==Language.English?": ":" : ",t.PeriodOfferStatusID==4||t.PeriodOfferStatusID==5?($("#HighestOrAcceptedOffertxt").text(Translation.get("AcceptedOffer")+r),$("#HighestOrAccpetedPrice").text(Translation.get("NoOffer")),t.AcceptedBuyer=Translation.get("NoOffer")):($("#HighestOrAcceptedOffertxt").text(Translation.get("HighestOffer")+r),$("#HighestOrAccpetedPrice").text(Translation.get("NoOffer"))));t.OffersCount>0&&t.DisplayPeriodValues?((i===null||i===void 0?void 0:i.length)>0?$("#publicOfferPriceValue").text(LatestOffersModel.GetCurrencyOfferPriceFormatted(i[0],ApplicationState.CurrencyValue)):!u||$("#publicOfferPriceValue").text(LatestOffersModel.GetCurrencyOfferPriceFormatted(u,ApplicationState.CurrencyValue)),$("#publicOfferPrice,#listingPriceTitle").show(),$(".listedPDPTagContainer").addClass("listedPDPTagContainer")):t.OffersCount>0?($("#publicOfferPriceValue").text(t.OffersCount.toString()+" "+(t.OffersCount==1?Translation.get("Offer"):Translation.get("Offers"))),$("#publicOfferPrice,#listingPriceTitle").show(),$(".listedPDPTagContainer").addClass("listedPDPTagContainer")):($(".listedPDPTagContainer").removeClass("listedPDPTagContainer"),$("#publicOfferPrice,#listingPriceTitle").hide());(t.PeriodOfferStatusID==4||t.PeriodOfferStatusID==5)&&($("#AcceptingOffersinfotxt").text(Translation.get("OfferAccepted")),t.AcceptedBuyer=i[0].BuyerNumber);(t.PeriodOfferStatusID==3||t.PeriodOfferStatusID==8)&&$("#AcceptingOffersinfotxt").text(Translation.get("ReviewingOffers"));(t.PeriodOfferStatusID==1||t.PeriodOfferStatusID==2)&&$("#AcceptingOffersinfotxt").text(Translation.get("AcceptingOffers"));$("#offersTimelinegrid").empty();t.OffersCount>0?($("#OfferTimelineOuterCon").removeClass("hide"),$.each(n.PublicOffers,function(i,r){var u,f="",e=r.PriceCurrencyFormat;(u=r.FXPrices)===null||u===void 0?void 0:u.forEach(function(n){f+=n.ExchangeName+n.Value+"_"});$("#offersTimelinegrid").append('<tr>\n                       <td  class=" textAlign"><div class="paddingColumns publicOfferContainer" data-value="'.concat(f,'" data-value-cad="').concat(e,'"><div class="publicOffer">').concat(n.PublicOfferPeriod.DisplayValues?LatestOffersModel.GetCurrencyOfferPriceFormatted(r,ApplicationState.CurrencyValue):Translation.get("Undisclosed"),"<\/div>").concat(r.HasConditions?'<div class="publicOfferDate">'+Translation.get("Conditional")+"<\/div>":"<span><\/span>",'<\/div><\/td>\n                       <td  class=" textAlign"><div class="paddingColumns"> <div class="BuyerId"><span class="publicOfferTag">').concat(r.BuyerNumber,'<\/span><\/div><div class="publicOfferDate">').concat(formatDateUpToYesterday(r.Timestamp,r.TimestampUTC,t.model.timeZoneName),"<\/div><\/div><\/td>\n                     "))})):$("#OfferTimelineOuterCon").addClass("hide");(t.PeriodOfferStatusID==4||t.PeriodOfferStatusID==5)&&t.OffersCount>0&&(n.PublicOffers.forEach(function(i,r){i.SourceOfferKey==n.PublicOfferPeriod.AcceptedSourceOfferKey&&(t.AcceptedOfferIndex=r)}),$("#offersTimelinegrid tr:nth-child("+(t.AcceptedOfferIndex+1)+")").addClass("highlightRow"));t.loadOpenOfferInfoIconTooltip()},i.prototype.initNewNotificationPublicOfferMsg=function(){var n=this,t=function(){var r=LocalStorage.PublicOffersNewMsgs.getObject()?LocalStorage.PublicOffersNewMsgs.getObject():{TriggerPageLoadFromResumeSearch:!1,MessageBoxAcknowledged:!1,CurrentPageLoadedFromResumeSearch:!1},i,t;r.MessageBoxAcknowledged||(i={PositiveBtnText:Translation.get("GotIt"),MainTextContent:Translation.get("NewNotifMsgForPublicOffers"),TitleText:Translation.get("LatestOffers")},t=new ControlFetcherArgs,t.idToOutputResults="publicOffersNewMsg",t.postCallHandler=function(){if($("#qtip-publicOffersToolTipBox").data("qtip")==null||$("#qtip-publicOffersToolTipBox").data("qtip").destroyed){var t={id:"publicOffersToolTipBox",style:{tip:{width:24,height:15,offset:40},classes:"popIn emphasizedDropShadow standardMsgFormStyle",width:300},position:{my:"top left",at:"bottom center",target:$("#listingPrice"),container:$("#listingDetailsTopInnerCon")},show:{modal:!1,ready:!1},hide:!1,events:{show:function(){Events.Listen(Controls.Desktop.CustomToolTipBox.customToolTipClosing,function(t){n.triggeredClosingNewPublicOffersMsg=!0;$(t.detail.parents(".qtip")[0]).qtip("enable");$(t.detail.parents(".qtip")[0]).qtip("hide");$(t.detail.parents(".qtip")[0]).qtip("disable");var i=LocalStorage.PublicOffersNewMsgs.getObject()?LocalStorage.PublicOffersNewMsgs.getObject():{TriggerPageLoadFromResumeSearch:!1,MessageBoxAcknowledged:!1,CurrentPageLoadedFromResumeSearch:!1};return i.MessageBoxAcknowledged=!0,LocalStorage.PublicOffersNewMsgs.saveObject(i),t.stopImmediatePropagation(),!1});$("#qtip-publicOffersToolTipBox").find(".tool-tip-main-box").removeClass("hide")},hide:function(t){n.triggeredClosingNewPublicOffersMsg||t.preventDefault()}}};Controls.Desktop.CustomToolTipBox.initToolTipContentAdvanced($("#publicOffersToolTipBoxWrap"),$("#publicOffersNewMsg"),$("#publicOffersNewMsg .publicOffers-message-main"),!1,t);$("#publicOffersNewMsg").show()}else $("#qtip-publicOffersNewMsgToolTipBox").qtip("enable"),$("#qtip-publicOffersNewMsgToolTipBox").qtip("show"),setTimeout(function(){var n=$(document).on("click",function(n){$(n.target).closest($("#qtip-publicOffersNewMsgToolTipBox")).hasClass("qtip-disabled")||($("#qtip-publicOffersNewMsgToolTipBox").qtip("enable"),$("#qtip-publicOffersNewMsgToolTipBox").qtip("hide"),$("#qtip-publicOffersNewMsgToolTipBox").qtip("disable"))})},1)},ControlFetcher.fetchPublicOffersNewMessage(t,i))};t()},i.ViewingStatistics="ViewingStatistics",i.rateHubJSLoaded="rateHubJSLoaded",i}(WebPage);t.Listing=i})(t=n.Desktop||(n.Desktop={}))})(Pages||(Pages={}))