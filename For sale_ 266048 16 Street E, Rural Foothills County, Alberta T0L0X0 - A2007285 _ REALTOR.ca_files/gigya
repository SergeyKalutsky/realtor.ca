var Gigya=function(){function n(){}return n.SignInPopup=function(){ApplicationState.IsMobileDevice?MasterPages.Phone.smoothState.load(RouteHelper.getURL("sign-in")):$("#lnkProfileMenuSignin").click()},n.LoginJS=function(t){var i={loginID:t.email,password:t.password,callback:n.onLoginJS};typeof gigya!="undefined"?gigya.accounts.login(i):showMessage(Translation.get("GigyaLoadError"),MessageType.Error,DisplayType.Lightbox)},n.onLoginJS=function(t){$("#btnSignIn, #btnSignInPrev").removeClass("loading");t.errorCode==0?(ApplicationState.UserIsSignedIn=!0,URLHash.get("section")=="SignIn"&&(URLHash.remove("section",!0),window.location.hash==""&&URLHash.removeHash(!1))):n.errorHandler(t,null,t.errorCode,null)},n.ReactivateLogin=function(t,i){var r=new AccountSetInfoArgs,u,f;r.profile="";r.data="";r.CRM_update=!1;r.isReactivate=!0;r.UID=t;r.CRMUID=i;u=null;LocalStorage.getObject("account_reactivate")!=null&&(u=new ConsumerProfile.Consumer(LocalStorage.getObject("account_reactivate")),u.GigyaError.ErrorCode==-10&&(u.GigyaError.ErrorCode=0));f=new SetAccountInfoCallbackArgs;f.onSuccessFunc.push(function(){n.loginHandler(u);ApplicationState.IsMobileDevice?Core.redirectTo(RouteHelper.getURL("")):n.hide_gigyaScreen(gigyaScreen.SignIn);LocalStorage.removeObject("account_reactivate")});n.AccountSetInfo(r,f)},n.Login=function(t,i){Actions.accountsLogin(t,n.loginHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)},i)},n.loginHandler=function(t,i){var r,u,e,o,f,s;GigyaLastPostFormMsg=null;t!=null&&(t.GigyaError.ErrorCode==0?($("#btnSignIn, #btnSignInPrev").removeClass("loading"),ApplicationState.UserIsSignedIn=!0,URLHash.get("section")=="SignIn"&&(URLHash.remove("section",!0),window.location.hash==""&&URLHash.removeHash(!1)),ApplicationState.GuestNotifyChgPending?(Events.RemoveListeners({uniqueKey:"DeferredImportSavedSearches"}),n.DeferredImportSavedSearches.ListenOnce(function(i){var r,f=(r=i===null||i===void 0?void 0:i.detail)===null||r===void 0?void 0:r.waitForSearchSaved,u;f?(Events.RemoveListeners({uniqueKey:"consumerSavedSearchesSuccess"}),SavedSearch.consumerSavedSearchesSuccess.ListenOnce(function(){Events.RemoveListeners({uniqueKey:"consumerProfileLoaded"});GigyaInit.Events.consumerProfileLoaded.ListenOnce(function(){var i=n.importCheck(t,!0);i!=null&&n.importConfirmation()},{uniqueKey:"consumerProfileLoaded"})},{uniqueKey:"consumerSavedSearchesSuccess"})):(u=n.importCheck(t,!0),u!=null&&n.importConfirmation())},{uniqueKey:"DeferredImportSavedSearches"})):n.importCheck(t),ConsumerProfile.UserAccountSettings.setLoginAttemptCount(0,t.user.email),Cookie.LoginCaptchaRequired.save("false"),r=new Dictionary,!LocalStorage.LastLoginTypeList.get()||(u=JSON.parse(LocalStorage.LastLoginTypeList.get()),r.AddList(u.values,u.keys)),r.Item(t.LoginProviderType.Type.toString())||r.Add(t.LoginProviderType.Type.toString(),{Type:t.LoginProviderType.Type,TimeStamp:(new Date).getTime()}),e={values:r.Values(),keys:r.Keys()},LocalStorage.LastLoginTypeList.saveObject(e),GigyaInit.loadConsumerProfile(t),n.loadNotifications(t),o=GigyaInit.DrawDialogs(t),f=new FavouriteRefreshArgs,f.total=Favourite.getAll().length,Favourite.favouritesRefreshEvent.Fire(f),s=SavedSearch.GetAll().length,SavedSearch.savedSearchesCountUpdated.Fire({count:s}),GigyaInit.Events.consumerLoggedIn.Fire({consumer:t,dialogsQueue:o}),n.startIdleTimeout()):(ApplicationState.UserIsSignedIn=!1,n.errorHandler(t,formType.signIn,null,i)));$("#btnSignIn, #btnSignInPrev").removeClass("loading");$("#btnLinkAccount").removeClass("loading")},n.autoLoginHandler=function(t){var r=new SocializeResponseLoginArgs,i,u,f;r.response=t;t.user.newUser?($(".signInSocialRow").hide(),$(".sm_button").hide(),$(".signInTabConSocialIconsCon").append('<div class="sk-spinning-circle" style="text-align:center;margin: 0 auto;margin-top:30px;"><\/div>'),i=new SetAccountInfoArgs,i.UID=t.UID,i.profile='{"locale":"'+ApplicationState.LanguageAttribute+'"}',i.data="",i.regToken="",i.conflictHandling="saveProfileAndFail",u=new SetAccountInfoCallbackArgs,f=function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)},u.onSuccessFunc.push(function(){Actions.socializeResponseLogin(r,n.socializeLoginHandler,f)}),u.onFailFunc.push(function(){Actions.socializeResponseLogin(r,n.socializeLoginHandler)}),n.SetAccountInfo(i,u)):Actions.socializeResponseLogin(r,n.socializeLoginHandler)},n.SocializeLogin=function(t){var i={provider:t.provider,callback:n.onSocializeLogin,loginMode:t.loginMode,regToken:t.regToken,sessionExpiration:t.session_expiration};typeof gigya!="undefined"?gigya.socialize.login(i):showMessage(Translation.get("GigyaLoadError"),MessageType.Error,DisplayType.Lightbox)},n.onNotifyRegistration=function(t){t.errorCode!=0&&n.errorHandler(null,null,parseInt(t.errorCode))},n.onSocializeLogin=function(t){var i,r;t.errorCode==0||(t.errorCode==GigyaErrorCodes.PendingAccountRegistration?t.x_newUser?($(".signInSocialRow").hide(),$(".sm_button").hide(),$(".signInTabConSocialIconsCon").append('<div class="sk-spinning-circle" style="text-align:center;margin: 0 auto;margin-top:30px;"><\/div>'),i=new SetAccountInfoArgs,i.UID=t.UID,i.profile='{"locale":"'+ApplicationState.LanguageAttribute+'"}',i.data="",i.regToken="",i.conflictHandling="saveProfileAndFail",r=new SetAccountInfoCallbackArgs,r.onSuccessFunc.push(function(){n.socializeFinalizeLogin(t)}),r.onFailFunc.push(function(){n.socializeFinalizeLogin(t)}),n.SetAccountInfo(i,r)):n.socializeFinalizeLogin(t):t.errorCode==GigyaErrorCodes.LoginIdentifierExists?(globalRegToken=t.regToken,globalRequestSMProvider=t.requestParams.provider.toUpperCase(),n.LinkAccounts(null)):t.errorCode==GigyaErrorCodes.AccountLinked?(globalRegToken=t.regToken,n.callError(null,t.errorCode),GigyaLastPostFormMsg={errorCode:t.errorCode,formType:formType.signIn,screenRender:null},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)):(n.callError(t,t.errorCode),GigyaLastPostFormMsg={errorCode:t.errorCode,formType:formType.signIn,screenRender:null},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)))},n.socializeFinalizeLogin=function(t){globalRegToken=t.regToken;globalRequestSMProvider=t.requestParams.provider.toUpperCase();var i=new GetAccountInfoArgs;i.UID=t.UID;i.errorCode=t.errorCode;Actions.getAccountInfo(i,n.errorHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.socializeLoginHandler=function(t){var i,r,f,e,u,o;GigyaLastPostFormMsg=null;t!=null&&(t.GigyaError.ErrorCode==0?(ApplicationState.UserIsSignedIn=!0,ApplicationState.IsMobileDevice||n.hide_gigyaScreen(gigyaScreen.SignIn),URLHash.get("section")=="SignIn"&&(URLHash.remove("section",!0),window.location.hash==""&&URLHash.removeHash(!1)),ApplicationState.GuestNotifyChgPending?(Events.RemoveListeners({uniqueKey:"DeferredImportSavedSearches"}),n.DeferredImportSavedSearches.ListenOnce(function(i){var r,f=(r=i===null||i===void 0?void 0:i.detail)===null||r===void 0?void 0:r.waitForSearchSaved,u;f?(Events.RemoveListeners({uniqueKey:"consumerSavedSearchesSuccess"}),SavedSearch.consumerSavedSearchesSuccess.ListenOnce(function(){Events.RemoveListeners({uniqueKey:"consumerProfileLoaded"});GigyaInit.Events.consumerProfileLoaded.ListenOnce(function(){var i=n.importCheck(t,!0);i!=null&&n.importConfirmation()},{uniqueKey:"consumerProfileLoaded"})},{uniqueKey:"consumerSavedSearchesSuccess"})):(u=n.importCheck(t,!0),u!=null&&n.importConfirmation())},{uniqueKey:"DeferredImportSavedSearches"})):n.importCheck(t),ConsumerProfile.UserAccountSettings.setLoginAttemptCount(0,t.user.email),Cookie.LoginCaptchaRequired.save("false"),i=new Dictionary,!LocalStorage.LastLoginTypeList.get()||(r=JSON.parse(LocalStorage.LastLoginTypeList.get()),i.AddList(r.values,r.keys)),i.Item(t.LoginProviderType.Type.toString())||i.Add(t.LoginProviderType.Type.toString(),{Type:t.LoginProviderType.Type,TimeStamp:(new Date).getTime()}),f={values:i.Values(),keys:i.Keys()},LocalStorage.LastLoginTypeList.saveObject(f),GigyaInit.loadConsumerProfile(t),n.loadNotifications(t),e=GigyaInit.DrawDialogs(t),u=new FavouriteRefreshArgs,u.total=Favourite.getAll().length,Favourite.favouritesRefreshEvent.Fire(u),o=SavedSearch.GetAll().length,SavedSearch.savedSearchesCountUpdated.Fire({count:o}),GigyaInit.Events.consumerLoggedIn.Fire({consumer:t,dialogsQueue:e}),n.startIdleTimeout()):(ApplicationState.UserIsSignedIn=!1,n.errorHandler(t,formType.signIn)))},n.Register=function(t){Actions.accountsRegister(t,n.registerHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.registerHandler=function(t){GigyaLastPostFormMsg=null;t!=null&&(t.GigyaError.ErrorCode==0||t.GigyaError.ErrorCode==GigyaErrorCodes.PendingAccountVerification?(n.showScreen(gigyaScreen.CheckYourEmail,t),GigyaLastPostFormMsg={errorCode:t.GigyaError.ErrorCode,formType:formType.signUp,screenRender:gigyaScreen.CheckYourEmail},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)):n.errorHandler(t,formType.signUp));$("#btnSignUp").removeClass("loading")},n.Logout=function(t){Cookie.FWDAccountURL.delete();Actions.accountsLogout(n.logoutHandler,t,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.logoutHandler=function(n,t){var i,r,u;n!=null&&(i=-1,i=Number(n.d),i==0&&(GigyaDialogs=[],LocalAccountStorage.SavedSearchesCP.delete(),LocalAccountStorage.NotesCP.delete(),LocalAccountStorage.FavouritesCP.delete(),LocalAccountStorage.ViewPrefCP.delete(),ConsumerProfile.UserAccountSettings.clear(),ApplicationState.IsMobileDevice?(GigyaInit.ConsumerSearchCriteria={},Events.ListenOnce(WebPage.pageLoadedEvent,function(){showMessage(Translation.get("SignedOut"))},{scope:Events.ListenerScope.Global})):SessionStorage.ToastToShowOnNextPage.save(Translation.get("SignedOut"))),location.href.toLowerCase().indexOf(RouteHelper.getURL("my-account"))>=0?Core.redirectTo(RouteHelper.getURL(""),!1):Core.redirectTo(window.location.href,!1),dlgs=null,ApplicationState.UserIsSignedIn=!1,r=new FavouriteRefreshArgs,r.total=Favourite.getAll().length,Favourite.favouritesRefreshEvent.Fire(r),Events.Fire(ConsumerProfile.Notifications.notificationsRefreshEvent,null),u=SavedSearch.GetAll().length,SavedSearch.savedSearchesCountUpdated.Fire({count:u}),BroadcastChannels.UserSignOut.sendMessage({}),GigyaInit.Events.consumerLoggedOut.Fire(),Cookie.SocialSignin.delete(),t!=null&&t.URLHash!=null&&t.URLHash)},n.GetSchemaOrFinalizeReg=function(t){LocalStorage.saveObject("206001_profile",t);n.getSchemaOrFinalizeRegHandler(null)},n.getSchemaOrFinalizeRegHandler=function(){var t=null,i;LocalStorage.getObject("206001_profile")!=null&&(t=new ConsumerProfile.Consumer(LocalStorage.getObject("206001_profile")));t.profile!=null&&(t.profile.email==null||t.profile.firstName==null||t.profile.lastName==null)?(n.showScreen(gigyaScreen.MoreInfoRequired,t),GigyaLastPostFormMsg={errorCode:GigyaErrorCodes.NoGigyaError,formType:formType.signIn,screenRender:gigyaScreen.MoreInfoRequired},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)):(i=new RegFinalArgs,i.regToken=t.regToken,Actions.accountsFinalizeRegistration(i,n.finalizeRegistrationHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)}));LocalStorage.removeObject("206001_profile")},n.finalizeRegistrationHandler=function(t){n.hide_gigyaScreen(gigyaScreen.LinkAccounts);t!=null&&(t.GigyaError.ErrorCode==0?(ApplicationState.UserIsSignedIn=!0,ConsumerProfile.UserAccountSettings.setLoginAttemptCount(0,t.user.email),Cookie.LoginCaptchaRequired.save("false"),n.FinalizeRegistrationLogin(t)):n.errorHandler(t,null,t.GigyaError.ErrorCode))},n.FinalizeRegistrationLogin=function(n){ApplicationState.IsMobileDevice?Core.redirectTo(RouteHelper.getURL("my-account"),!1):(GigyaInit.loadConsumerProfile(n),GigyaInit.Events.consumerLoggedIn.Fire({consumer:n,dialogsQueue:GigyaInit.DrawDialogs(n)}))},n.ResendEmailVerification=function(t){n.showScreen(gigyaScreen.ResendEmailVerification,t);GigyaLastPostFormMsg={errorCode:GigyaErrorCodes.NoGigyaError,formType:formType.signUp,screenRender:gigyaScreen.ResendEmailVerification};GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)},n.resendEmailVerificationHandler=function(t){t!=null&&(t.GigyaError.ErrorCode==0?(n.hide_gigyaScreen(gigyaScreen.ResendEmailVerification),n.GigyaScreenClose.Fire({screen:gigyaScreen.ResendEmailVerification}),n.showScreen(gigyaScreen.CheckYourEmail,t),GigyaLastPostFormMsg={errorCode:GigyaErrorCodes.NoGigyaError,formType:formType.signUp,screenRender:gigyaScreen.CheckYourEmail},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)):showMessage(t.GigyaError.ErrorMsg,MessageType.Error))},n.LinkAccounts=function(t){n.showScreen(gigyaScreen.LinkAccounts,t);GigyaLastPostFormMsg={errorCode:GigyaErrorCodes.NoGigyaError,formType:formType.signUp,screenRender:gigyaScreen.LinkAccounts};GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)},n.DeleteAccount=function(t){Actions.accountsDeleteAccount(t,n.deleteAccountHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.deleteAccountHandler=function(t){t!=null&&(t.ErrorCode.Id==200?Logging.Debug("DeleteAccount Success",LogType.Other):showMessage(t.ErrorCode.Description,MessageType.Error),n.hide_gigyaScreen(gigyaScreen.SocialTerms),n.hide_gigyaScreen(gigyaScreen.MoreAboutYou),dlgs=null,GigyaDialogs=[],Cookie.SocialSignin.delete(),ApplicationState.IsMobileDevice?(GigyaInit.ConsumerSearchCriteria={},Events.ListenOnce(WebPage.pageLoadedEvent,function(){showMessage(Translation.get("SignedOut"))},{scope:Events.ListenerScope.Global})):SessionStorage.ToastToShowOnNextPage.save(Translation.get("SignedOut")),location.href.toLowerCase().indexOf(RouteHelper.getURL("my-account"))>=0?Core.redirectTo(RouteHelper.getURL(""),!1):Core.redirectTo(window.location.href,!1),dlgs=null,ApplicationState.UserIsSignedIn=!1,BroadcastChannels.UserSignOut.sendMessage({}))},n.Reactivate=function(t){LocalStorage.saveObject("account_reactivate",t);n.showScreen(gigyaScreen.SignIn,t)},n.callError=function(t,i){var r=$("#signInAccount").is(":visible")&&!$("#signInAccount").hasClass("hideme"),u=r?$("#genericSignInAccountError"):$("#genericSignInError,#genericSignInErrorPrev"),f,e;i==GigyaErrorCodes.PendingAccountRegistration&&n.GetSchemaOrFinalizeReg(t);i==GigyaErrorCodes.PendingAccountVerification&&n.ResendEmailVerification(t);i==GigyaErrorCodes.InvalidLoginId&&(ConsumerProfile.UserAccountSettings.InvalidLoginCount++,SessionStorage.LoginAttempts.save(ConsumerProfile.UserAccountSettings.InvalidLoginCount.toString(),"InvalidLoginCount-"+r?$("#signInEmailTxt").val():$("#signInEmailTxtPrev").val()),ConsumerProfile.UserAccountSettings.InvalidLoginCount==9?FormValidation.throwFieldAsInvalid(u,Translation.get("InvalidLogin9")):FormValidation.throwFieldAsInvalid(u,Translation.get("InvalidLoginId")));i==GigyaErrorCodes.LoginIdentifierExists&&n.LinkAccounts(t);i==GigyaErrorCodes.AccountLinked&&(n.hide_gigyaScreen(gigyaScreen.LinkAccounts),f=new RegFinalArgs,f.regToken=globalRegToken,Actions.accountsFinalizeRegistration(f,n.finalizeRegistrationHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)}));i==GigyaErrorCodes.ErrorLoginIdentifierExists&&(globalRegToken=t.regToken,n.LinkAccounts(null));i==GigyaErrorCodes.DeactivatedAccount&&n.Reactivate(t);i==GigyaErrorCodes.LoggedOutError&&(e=new LogoutCallbackArgs,e.DT=DisplayType.Tempbox,n.Logout(e));i==GigyaErrorCodes.TempAccountLockedOut&&(FormValidation.throwFieldAsInvalid(u,Translation.get("AccountLocked")),ConsumerProfile.UserAccountSettings.setLoginAttemptCount(0,r?$("#signInEmailTxt").val():$("#signInEmailTxtPrev").val()));i==GigyaErrorCodes.CaptchaRequired&&Cookie.LoginCaptchaRequired.save("true")},n.errorHandler=function(t,i,r,u){var c,o;FormValidation.clearFieldValidation;ConsumerProfile.UserAccountSettings.getLoginAttemptCount();var s=$("#signInAccount").is(":visible")&&!$("#signInAccount").hasClass("hideme"),e=s?$("#genericSignInAccountError"):$("#genericSignInError,#genericSignInErrorPrev"),l=$("#genericSignUpError"),h=s?$("#signInPasswordTxt"):$("#signInPasswordTxtPrev"),f=0;f=t!=null?t.GigyaError!=null?t.GigyaError.ErrorCode:t.errorCode:r;GigyaLastPostFormMsg={errorCode:f,formType:i,screenRender:null};GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg);u!=null&&u.sourceScreen==gigyaScreen.LinkAccounts&&(e=$("#genericSignInErrorLinkAccounts"),h=$("#linkAccountPasswordTxt"));f==GigyaErrorCodes.PendingAccountRegistration?n.callError(t,GigyaErrorCodes.PendingAccountRegistration):f==GigyaErrorCodes.PendingAccountVerification?n.callError(t,GigyaErrorCodes.PendingAccountVerification):f==GigyaErrorCodes.CaptchaRequired?Cookie.LoginCaptchaRequired.save("true"):f==GigyaErrorCodes.WrongCaptchaEntered?FormValidation.throwFieldAsInvalid(e,Translation.get("CaptchaValidation")):f==GigyaErrorCodes.OldPassword?FormValidation.throwFieldAsInvalid(h,Translation.get("OldPasswordUsed")):f==GigyaErrorCodes.InvalidLoginId?(ConsumerProfile.UserAccountSettings.InvalidLoginCount++,SessionStorage.LoginAttempts.save(ConsumerProfile.UserAccountSettings.InvalidLoginCount.toString(),"InvalidLoginCount-"+s?$("#signInEmailTxt").val():$("#signInEmailTxtPrev").val()),ConsumerProfile.UserAccountSettings.InvalidLoginCount==9?FormValidation.throwFieldAsInvalid(e,Translation.get("InvalidLogin9")):FormValidation.throwFieldAsInvalid(e,Translation.get("InvalidLoginId"))):f==GigyaErrorCodes.LoginIdentifierExists?n.callError(t,GigyaErrorCodes.LoginIdentifierExists):f==GigyaErrorCodes.AccountLinked?(globalRegToken=t.regToken,n.callError(t,GigyaErrorCodes.AccountLinked)):f==GigyaErrorCodes.ErrorLoginIdentifierExists?n.callError(t,GigyaErrorCodes.ErrorLoginIdentifierExists):f==GigyaErrorCodes.PendingPasswordChange?FormValidation.throwFieldAsInvalid(h,t.GigyaError.ErrorMsg):f==GigyaErrorCodes.TempAccountLockedOut?(FormValidation.throwFieldAsInvalid(e,Translation.get("AccountLocked")),ConsumerProfile.UserAccountSettings.setLoginAttemptCount(0,s?$("#signInEmailTxt").val():$("#signInEmailTxtPrev").val())):f==GigyaErrorCodes.WrongCaptcha?showMessage(t.GigyaError.ErrorMsg+" Wrong Captcha",MessageType.Error):f==GigyaErrorCodes.DeactivatedAccount?n.callError(t,GigyaErrorCodes.DeactivatedAccount):f==GigyaErrorCodes.LoggedOutError?(c=new LogoutCallbackArgs,c.DT=DisplayType.Tempbox,n.Logout(c)):f==GigyaErrorCodes.UnknownError?FormValidation.throwFieldAsInvalid(e,Translation.get("LogErrorMessage")):t.validationErrors!=null?(o="",t.validationErrors[0].errorCode==400003?(o=Translation.get("EmailExists"),FormValidation.markFieldAsInvalid($("#signInSignUpEmailTxt"),o)):(o=o+t.validationErrors[0].message+" ",FormValidation.throwFieldAsInvalid(l,o,"signUp"))):showMessage(t.GigyaError.ErrorMsg,MessageType.Error)},n.showScreen=function(t,i,r,u){$.featherlight.close();n.fetchScreen(t,i,r,!0,u)},n.appendScreenHTML=function(n){var t="header_locked_"+n,i=$("#header").width()+3;$("#"+n).length<=0&&($("body").append("<div id='"+n+"' class='gigya_screen'><\/div>"),$("#"+t).length<=0&&($("#pageContent").append("<div id='"+t+"' class='header_locked'><\/div>"),$("#"+t).css("width",i)))},n.appendScreenHTML2=function(n,t){var i="header_locked_"+n,r=$("#header").width()+3;$("#"+n).length<=0&&($("body").append("<div id='"+n+"' class='gigya_screen'>"+t.d+"<\/div>"),$("#"+i).length<=0&&($("#pageContent").append("<div id='"+i+"' class='header_locked'><\/div>"),$("#"+i).css("width",r)))},n.fetchScreen=function(t,i,r,u,f){var s,a,h,c,e,o,l;u===void 0&&(u=!1);i==null&&(i=new ConsumerProfile.Consumer(null));s=function(){u&&SetFocusOnFirstInput($("#"+gigyaScreen[t]));f!=null&&f()};switch(t){case gigyaScreen.SaveMoreFavs:var e=new ControlFetcherArgs("screen_SaveMoreFavs"),o=new ScreenGenericControlArgs,tt=gigyaScreen[t];ApplicationState.IsMobileDevice?showMessage(Translation.get("FavouriteLimit"),null,DisplayType.Tempbox):(e.idToOutputResults=tt,e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(tt,Translation.get("SaveMoreFavourites"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){URLHash.remove("section",!0);n.GigyaScreenClose.Fire({screen:gigyaScreen.SaveMoreFavs})};showModalContent(i);s()},ControlFetcher.fetchSaveMoreFavs(e,o));break;case gigyaScreen.SignIn:e=new ControlFetcherArgs("screen_SignIn");o=new ScreenSignInArgs;o.User=i;a=gigyaScreen[t];ApplicationState.IsMobileDevice?(Cookie.ReactivateCondition.save(i.reactivateCondition?"True":"False"),Cookie.ReactivateUID.save(i.UID),Cookie.ReactivateCRMUID.save(i.CRMUID),Cookie.ReactivateStatus.save(i.Account_Status.Status),Core.redirectTo(RouteHelper.getURL("sign-in"))):(e.idToOutputResults=a,e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(a,Translation.get("SignIn"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){URLHash.remove("section",!0);n.GigyaScreenClose.Fire({screen:gigyaScreen.SignIn})};showModalContent(i);s()},ControlFetcher.fetchScreenSignIn(e,o));break;case gigyaScreen.MoreInfoRequired:e=new ControlFetcherArgs("screen_MoreInfoRequired");o=new ScreenMoreInfoControlArgs;o.firstName=i.profile.firstName;o.lastName=i.profile.lastName;o.email=i.profile.email;h=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=h,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(h,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenMoreInfo(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(h,Translation.get("MoreMandatoryInformation"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.MoreInfoRequired})};showModalContent(i)},ControlFetcher.fetchScreenMoreInfo(e,o));break;case gigyaScreen.MoreAboutYou:var e=new ControlFetcherArgs("screen_MoreAboutYou"),o=new ScreenGenericControlArgs,v=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=v,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(v,i);n.show_gigyaScreen(t);s();n.GigyaScreenOpen.Fire({screen:gigyaScreen.MoreAboutYou})},ControlFetcher.fetchScreenMoreAboutYou(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(v,Translation.get("MoreAboutYou"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.ShowCloseButton=!1;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.MoreAboutYou})};showModalContent(i)},ControlFetcher.fetchScreenMoreAboutYou(e,o));break;case gigyaScreen.ResendEmailVerification:e=new ControlFetcherArgs("screen_ResendEmailVerification");o=new ScreenResendEmailVerificationControlArgs;o.UID=i.UID||"";o.regToken=i.regToken||"";c=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=c,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(c,i);n.show_gigyaScreen(t);s();n.GigyaScreenOpen.Fire({screen:gigyaScreen.ResendEmailVerification})},ControlFetcher.fetchScreenResendEmailVerification(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(c,Translation.get("EmailNotVerified"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.ResendEmailVerification})};showModalContent(i)},ControlFetcher.fetchScreenResendEmailVerification(e,o));break;case gigyaScreen.CheckYourEmail:var e=new ControlFetcherArgs("screen_CheckYourEmail"),o=new ScreenGenericControlArgs,y=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=y,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(y,i);n.show_gigyaScreen(t);s();n.GigyaScreenOpen.Fire({screen:gigyaScreen.CheckYourEmail})},ControlFetcher.fetchScreenCheckYourEmail(e,o)):(e.canRetrieveFromCache=!0,e.postCallHandler=function(t){var i=new ModalContentModel(y,Translation.get("WelcomeSignUp"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.CheckYourEmail})};showModalContent(i)},ControlFetcher.fetchScreenCheckYourEmail(e,o));break;case gigyaScreen.RevisedTerms:var e=new ControlFetcherArgs("screen_RevisedTerms"),o=new ScreenGenericControlArgs,p=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=p,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(p,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenRevisedTerms(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(p,Translation.get("TOUListingPageTitle"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.ShowCloseButton=!1;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.RevisedTerms})};i.AfterOpen=function(){setTimeout(function(){$(".LegalCon").scrollTop(0)},200)};showModalContent(i)},ControlFetcher.fetchScreenRevisedTerms(e,o));break;case gigyaScreen.SocialTerms:var e=new ControlFetcherArgs("screen_SocialTerms"),o=new ScreenGenericControlArgs,w=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=w,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(w,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenSocialTerms(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(w,Translation.get("TOUListingPageTitle"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.ShowCloseButton=!1;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.SocialTerms})};i.AfterOpen=function(){setTimeout(function(){$(".LegalCon").scrollTop(0)},200)};showModalContent(i)},ControlFetcher.fetchScreenSocialTerms(e,o));break;case gigyaScreen.LinkAccounts:var e=new ControlFetcherArgs("screen_LinkAccounts"),o=new ScreenGenericControlArgs,b=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=b,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(b,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenLinkAccounts(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(b,Translation.get("EnableNewSocialMediaAccount"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.ShowCloseButton=!1;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.LinkAccounts})};showModalContent(i)},ControlFetcher.fetchScreenLinkAccounts(e,o));break;case gigyaScreen.ForgotPassword:var e=new ControlFetcherArgs("screen_ForgotPassword"),o=new ScreenGenericControlArgs,k=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=k,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(k,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenForgotPassword(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(k,Translation.get("ForgotPassword"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.ForgotPassword})};showModalContent(i)},ControlFetcher.fetchScreenForgotPassword(e,o));break;case gigyaScreen.ChangePassword:e=new ControlFetcherArgs("screen_ChangePassword");o=new ScreenChangePasswordArgs;o.pwrtToken=Utilities.getParamValueByName("pwrt",URLParamType.Query);l=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=l,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(l,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenChangePassword(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(l,Translation.get("ChangeYourPassword"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){Utilities.removeQueryViaState();n.GigyaScreenClose.Fire({screen:gigyaScreen.ChangePassword})};showModalContent(i)},ControlFetcher.fetchScreenChangePassword(e,o));break;case gigyaScreen.ChangeAccountPassword:var e=new ControlFetcherArgs("screen_ChangeAccountPassword"),o=new ScreenGenericControlArgs,d=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=d,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(d,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenChangeAccountPassword(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(d,Translation.get("ChangeYourPassword"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.ChangeAccountPassword})};showModalContent(i)},ControlFetcher.fetchScreenChangeAccountPassword(e,o));break;case gigyaScreen.ChangeAccountEmail:var e=new ControlFetcherArgs("screen_ChangeAccountEmail"),o=new ScreenGenericControlArgs,g=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=g,e.canRetrieveFromCache=!0,e.postCallHandler=function(i){n.appendScreenHTML2(g,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenChangeAccountEmail(e,o)):(e.canRetrieveFromCache=!0,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(g,Translation.get("ChangeYourEmail"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.ChangeAccountEmail})};showModalContent(i)},ControlFetcher.fetchScreenChangeAccountEmail(e,o));break;case gigyaScreen.UnsubscribeConfirmation:var e=new ControlFetcherArgs("screen_UnsubscribeConfirmation"),o=r,nt=gigyaScreen[t];ApplicationState.IsMobileDevice?(e.idToOutputResults=nt,e.canRetrieveFromCache=!1,e.postCallHandler=function(i){n.appendScreenHTML2(nt,i);n.show_gigyaScreen(t);s()},ControlFetcher.fetchScreenUnsubscribeConfirmation(e,o)):(e.canRetrieveFromCache=!1,e.showLoadingSpinner=!0,e.postCallHandler=function(t){var i=new ModalContentModel(nt,Translation.get("UnsubFromRealtorApp"),t.d);i.CssClass="gigyaScreen";i.DisplayType=ModalDisplayTypes.LightboxMe;i.AfterClose=function(){n.GigyaScreenClose.Fire({screen:gigyaScreen.UnsubscribeConfirmation})};showModalContent(i)},ControlFetcher.fetchScreenUnsubscribeConfirmation(e,o))}},n.hide_gigyaScreen=function(n){var t=gigyaScreen[n],i,r,u,f;ApplicationState.IsMobileDevice?(i="header_locked_"+t,$("#"+t).hasClass("show")&&($("#"+t).removeClass("show"),window.setTimeout(function(){$("body").css("overflow","initial");$("body").css("position","initial");$("#"+t).remove();$("#"+i).remove()},320))):(r=$("#"+t).closest(".ModalOverlay"),r.trigger("close"),u=$("#"+t).closest(".modalcontrol"),f=$("#"+t+"_con"),$(u).remove(),$(f).remove());n==gigyaScreen.ChangePassword&&Utilities.removeQueryViaState()},n.show_gigyaScreen=function(n){var i=$("#header").outerHeight(),t=gigyaScreen[n],r;ApplicationState.IsMobileDevice&&($("body").css("overflow","hidden"),$("#"+t).addClass("show"),$("#"+t).css("top",i),r=window.innerHeight?window.innerHeight:$(window).height(),$("#"+t).css("height",r-i))},n.resize_gigyaScreen=function(n){var t=$("#header").outerHeight(),i=gigyaScreen[n],r;$("#"+i).css("top",t);r=$(window).height()?$(window).height():window.innerHeight;$("#"+i).css("height",r-t)},n.exitLinkConfirmHandler=function(){var n=$("#pnlExitLinkConfirmMsg_body").text();n.indexOf("[0]")>-1&&(n=n.replace("[0]",globalRequestSMProvider),$("#pnlExitLinkConfirmMsg_body").text(n))},n.showDialogEditNote=function(t){var i=new ConfirmationDialog2Args,r="",u;i.ID="note"+t.ID;i.TitleText="&nbsp;";t.isSharedNote&&(r+="<div id='sharedNoteCnt'><span id='sharedNoteTitle'>"+Note.getSharedDisplayName()+" - "+t.Address+"<\/span><div class='note-txtarea'><textarea maxlength='300' disabled='disabled' id='txtArea_SharedNote'><\/textarea><\/div><\/div>");r+=t.isSharedNote&&Note.exists(t.ID)?"<div id='myNoteCnt'><span id='myNoteTitle'>"+t.Address+"<\/span><div class='note-txtarea'><textarea maxlength='300' id='txtArea_Note' data-validation='required,blockchars(<>),nourls'><\/textarea><\/div><\/div>":"<div id='myNoteCnt'><span id='myNoteTitle'>"+t.Address+"<\/span><div class='note-txtarea'><textarea maxlength='300' id='txtArea_Note' data-validation='required,blockchars(<>),nourls'><\/textarea><\/div><\/div>";i.TitleText=Translation.get("MyNotes");i.BodyContent=$(r);i.ButtonPositiveText=Translation.get("Save");i.ButtonNegativeText=Translation.get("Delete");i.ButtonPositiveOnClick=function(i,r){if($("#txtArea_Note").val()!=""){$("#"+r.model.ButtonPositiveID).addClass("loading");var u=function(){r.Featherlight.close();$("#"+r.model.ButtonPositiveID).removeClass("loading")};Note.Add(t.ID,$("#txtArea_Note").val(),t.Lat,t.Lon,"",!0,u)}else n.showDialogEmptyNote(r)};i.ButtonNegativeOnClick=function(n,i){t.CloseTrigger="delete";Note.DeleteConfirmation(t.ID,$("#txtArea_Note").val(),"",i,t.isPDP)};i.BeforeOpen=function(){$("#txtArea_Note").attr("placeholder",Translation.get("NotesTooltip"));t.isSharedNote&&Note.exists(t.ID)?$("#txtArea_Note").val(Note.getById(t.ID).note):t.isSharedNote?($("#txtArea_Note").hide(),$("#myNoteCnt").hide(),$("#"+i.ID+"_PositiveBtn").hide(),$("#"+i.ID+"_NegativeBtn").hide()):Note.exists(t.ID)&&$("#txtArea_Note").val(Note.getById(t.ID).note);t.isSharedNote&&Note.existsShared(t.ID)?$("#txtArea_SharedNote").val(Note.getSharedById(t.ID).note):($("#txtArea_SharedNote").hide(),$("#sharedNoteCnt").hide())};i.BeforeClose=function(){t.CloseTrigger=="delete"!=!0&&(Note.exists(t.ID)?$("#txtArea_Note").val()!=Note.getById(t.ID).note&&n.showDialogCancelNote(t,$("#txtArea_Note").val()):$("#txtArea_Note").val()!=""&&$("#txtArea_Note").val()!=undefined&&n.showDialogCancelNote(t,$("#txtArea_Note").val()))};i.AfterOpen=function(){window.setTimeout(function(){var n=$("#txtArea_Note");n.length>0&&n[0].focus()},50)};u=new ConfirmationDialogModel2(i.ID,i.TitleText,i.BodyContent,i.ButtonPositiveText,i.ButtonPositiveOnClick,i.ButtonNegativeText,i.ButtonNegativeOnClick,null,null,i.BeforeOpen,i.BeforeClose,i.AfterOpen);u.ShowCloseButton=!0;showConfirmationDialog2(u)},n.showDialogCancelNote=function(t,i){var r=new ConfirmationDialog2Args,u;r.ID="pnlConfirmMsgCancelNote";r.TitleText=Translation.get("T450");r.BodyContent=$("<span>"+Translation.get("M45")+"<\/span>");r.ButtonPositiveText=Translation.get("Yes");r.ButtonNegativeText=Translation.get("No");r.ButtonPositiveOnClick=function(n,t){t.Featherlight.close()};r.ButtonNegativeOnClick=function(r,u){u.Featherlight.close();n.showDialogEditNote(t);$("#txtArea_Note").val(i)};u=new ConfirmationDialogModel2(r.ID,r.TitleText,r.BodyContent,r.ButtonPositiveText,r.ButtonPositiveOnClick,r.ButtonNegativeText,r.ButtonNegativeOnClick);u.ShowCloseButton=!1;showConfirmationDialog2(u)},n.showDialogEmptyNote=function(n){var t=new ConfirmationDialog2Args,i;t.ID="pnlConfirmMsgEmptyNote";t.TitleText=Translation.get("T449");t.BodyContent=$("<span>"+Translation.get("M46")+"<\/span>");t.ButtonPositiveText=Translation.get("Yes");t.ButtonNegativeText=Translation.get("No");t.ButtonPositiveOnClick=function(t,i){i.Featherlight.close();n.Featherlight.close()};t.ButtonNegativeOnClick=function(n,t){t.Featherlight.close()};i=new ConfirmationDialogModel2(t.ID,t.TitleText,t.BodyContent,t.ButtonPositiveText,t.ButtonPositiveOnClick,t.ButtonNegativeText,t.ButtonNegativeOnClick);i.ShowCloseButton=!1;showConfirmationDialog2(i)},n.loadNotifications=function(n){var t,i,r,u=!1,f;n.user.Notifications!=null&&(ConsumerProfile.UserAccountSettings.FavNotificationsEnabled=((r=(i=(t=n.user.Notifications)===null||t===void 0?void 0:t.favourite)===null||i===void 0?void 0:i.filter(function(n){return n.method==NotificationMethod.Email.toString()}))===null||r===void 0?void 0:r.length)>0,ConsumerProfile.UserAccountSettings.CompareNotificationsEnabled=n.user.Notifications.compares);n.user.Searches!=null&&n.user.Searches.length>0&&(f=$.grep(n.user.Searches,function(n){return n.notify===!0}),f.length&&(ConsumerProfile.UserAccountSettings.SavedSearchNotificationsEnabled=!0));(ConsumerProfile.UserAccountSettings.FavNotificationsEnabled||ConsumerProfile.UserAccountSettings.CompareNotificationsEnabled||ConsumerProfile.UserAccountSettings.SavedSearchNotificationsEnabled)&&(u=!0);ConsumerProfile.UserAccountSettings.NotificationsEnabled=u;ConsumerProfile.UserAccountSettings.UserHashId=n.HashUID},n.setCPFavourites=function(n){if(n!=null){var t=[];$.each(n,function(i){(parseInt(n[i].appMode.toString())===ApplicationState.ResidentialMode||parseInt(n[i].appMode.toString())===ApplicationState.CommercialMode)&&t.push(n[i])});try{LocalAccountStorage.FavouritesCP.saveObject(t)}catch(i){}ApplicationState.IsMobileDevice?MasterPages.Phone.updateFavouriteIcon(Favourite.getAll().length):MasterPages.Desktop.updateFavouriteIcon(Favourite.getAll().length);Favourite.favouritesRefreshEvent.Fire({total:Favourite.getAll().length})}},n.setCPCompares=function(){},n.setCPSearches=function(n){if(n!=null){try{LocalAccountStorage.SavedSearchesCP.save(JSON.stringify(n))}catch(t){}ApplicationState.IsMobileDevice?MasterPages.Phone.updateSavedSearchIcon(SavedSearch.GetAll().length):MasterPages.Desktop.updateSavedSearchIcon(SavedSearch.GetAll().length);SavedSearch.savedSearchesCountUpdated.Fire({count:SavedSearch.GetAll().length})}},n.setCPNotes=function(n){if(n!=null){var t=[];$.each(n,function(i){t.push(n[i])});try{LocalAccountStorage.NotesCP.save(JSON.stringify(t))}catch(i){}}},n.setCPViewPref=function(n,t){var i=new ViewPref;n!=null&&(i.Res_View=n);t!=null&&(i.Com_View=t);try{LocalAccountStorage.ViewPrefCP.save(JSON.stringify(i))}catch(r){}},n.saveConsumerFavourites=function(){var r;if(ApplicationState.UserIsSignedIn){var u=Favourite.getAll(),t={},i=new AccountSetInfoArgs;t.Favourites=u;r=JSON.stringify(t);i.data=r;n.AccountSetInfo(i,null)}},n.saveConsumerCompares=function(){},n.combineConsumerDataAndSave=function(t,i){var r={},f=new AccountSetInfoArgs,u=new SetAccountInfoCallbackArgs,e,o,s;t.importFaveFlag&&!t.maxFaveFlag&&(o=Favourite.getAll(),r.Favourites=o);t.importSearchFlag&&!t.maxSearchFlag&&(s=SavedSearch.GetAll(),r.Searches=s);e=JSON.stringify(r);f.data=e;u.fetchNewConsumerBOL=i;u.onSuccessFunc.push(function(){var n=SavedSearch.GetAll().length;SavedSearch.savedSearchesCountUpdated.Fire({count:n});SavedSearch.consumerSavedSearchesSuccess.Fire({})});n.AccountSetInfo(f,u)},n.saveConsumerSearches=function(t){var f,i;if(t===void 0&&(t=!0),ApplicationState.UserIsSignedIn){var e=SavedSearch.GetAll(),r={},u=new AccountSetInfoArgs;r.Searches=e;f=JSON.stringify(r);u.data=f;i=new SetAccountInfoCallbackArgs;i.fetchNewConsumerBOL=t;i.onSuccessFunc.push(function(){var n=SavedSearch.GetAll().length;SavedSearch.savedSearchesCountUpdated.Fire({count:n});SavedSearch.consumerSavedSearchesSuccess.Fire({})});n.AccountSetInfo(u,i)}},n.saveConsumerNotes=function(t,i){var e;if(t===void 0&&(t=!1),ApplicationState.UserIsSignedIn){var o=Note.getAll(),u={},f=new AccountSetInfoArgs,r=new SetAccountInfoCallbackArgs;i!=null&&r.onSuccessFunc.push(i);u.Notes=o;e=JSON.stringify(u);f.data=e;t||(r.onSuccessMsg=Translation.get("M52"),r.onSuccessFunc.push(function(){Favourite.refreshIcons($("body"))}),r.onSuccessMsgDisplayType=DisplayType.Toast);n.AccountSetInfo(f,r)}},n.IdsSetLocale=function(){var n=$("html").attr("lang")},n.setLocale=function(t,i,r){if(t!=null)n.IdsSetLocale(t,null);else if(i!=null)n.IdsSetLocale(null,i);else if(ApplicationState.UserIsSignedIn)var u=$("html").attr("lang"),f="locale="+u;r()},n.AccountSetInfo=function(t,i){var r=new consumeruser,u=new consumeruser,f=null;try{t.profile!=""&&(r=JSON.parse(t.profile));t.data!=""&&(u=JSON.parse(t.data));f=$.extend(r,u)}catch(e){$("#btnMAYContinue").removeClass("loading")}Events.Fire(n.ProfileAccountInfoStartUpdate);Actions.accountsSetInfo(t,n.accountSetInfoHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)},i)},n.accountSetInfoHandler=function(t,i){var u,f,e,r;if(GigyaLastPostFormMsg==null,t!=null)if(f=Number((u=t.ErrorCode)===null||u===void 0?void 0:u.Id.toString())?parseInt(t.ErrorCode.Id.toString()):GigyaErrorCodes.NoGigyaError,t.ErrorCode.Id==200){if(i!=null){if(i.sourceScreen!=null&&(i.sourceScreen===gigyaScreen.SocialTerms&&Cookie.SocialSignin.save("1"),i.sourceScreen===gigyaScreen.MoreInfoRequired?(ApplicationState.UserIsSignedIn=!0,e={callback:n.onNotifyRegistration},typeof gigya!="undefined"&&gigya.socialize.notifyRegistration(e),n.hide_gigyaScreen(i.sourceScreen),n.GigyaScreenClose.Fire({screen:i.sourceScreen})):(n.hide_gigyaScreen(i.sourceScreen),n.GigyaScreenClose.Fire({screen:i.sourceScreen}))),i.targetScreen!=null&&n.showScreen(i.targetScreen,null,i.targetScreenOptions),i.redirectTargetOnSuccess!=null&&i.redirectTargetOnSuccess!=""&&Core.redirectTo(i.redirectTargetOnSuccess,!1),i.onSuccessMsg!=null&&i.onSuccessMsg!=""&&showMessage(i.onSuccessMsg,MessageType.Normal,i.onSuccessMsgDisplayType?i.onSuccessMsgDisplayType:DisplayType.Toast),i.onSuccessFunc!=null&&i.onSuccessFunc.length>0)for(r=0;r<i.onSuccessFunc.length;r++)i.onSuccessFunc[r]();i.fetchNewConsumerBOL&&GigyaInit.GetAccountFromBOL(!0);GigyaLastPostFormMsg={errorCode:f,formType:formType.profile,screenRender:i.sourceScreen};GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)}GigyaInit.ShiftDialogs();n.ProfileAccountInfoIsSet.Fire({isSet:!0,callBackArgs:i})}else i!=null&&(i.sourceScreen!=null&&n.hide_gigyaScreen(i.sourceScreen),GigyaLastPostFormMsg={errorCode:f,formType:formType.profile,screenRender:i.sourceScreen},GigyaInit.Events.consumerPostMsgForm.Fire(GigyaLastPostFormMsg)),n.callError(null,t.GigyaErrorCode),n.ProfileAccountInfoIsSet.Fire({isSet:!0,callBackArgs:i});$(".btnSaveAccountChanges").removeClass("loading");$("#btnMAYContinue").removeClass("loading")},n.AccountGetInfo=function(t){Actions.accountsGetInfo(t,n.accountGetInfoHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.accountGetInfoHandler=function(n){n!=null&&(n.ErrorCode.Id==200?Logging.Debug("AccountGetInfo Success",LogType.Other):showMessage(n.ErrorCode.Description,MessageType.Error))},n.SetAccountInfo=function(t,i){Actions.setAccountInfo(t,n.setAccountInfoHandler,i,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.setAccountInfoHandler=function(t,i){var u,r;if(t!=null)if(t.GigyaError.ErrorCode==0){if(i!=null&&(i.sourceScreen!=null&&(i.sourceScreen===gigyaScreen.MoreInfoRequired?(ApplicationState.UserIsSignedIn=!0,u={callback:n.onNotifyRegistration},typeof gigya!="undefined"&&gigya.socialize.notifyRegistration(u),n.hide_gigyaScreen(i.sourceScreen)):n.hide_gigyaScreen(i.sourceScreen)),i.targetScreen!=null&&n.showScreen(i.targetScreen,t,i.targetScreenOptions),i.redirectTargetOnSuccess!=null&&i.redirectTargetOnSuccess!=""&&Core.redirectTo(i.redirectTargetOnSuccess,!1),i.onSuccessMsg!=null&&i.onSuccessMsg!=""&&showMessage(i.onSuccessMsg,MessageType.Normal,i.onSuccessMsgDisplayType?i.onSuccessMsgDisplayType:DisplayType.Toast),i.onSuccessFunc!=null&&i.onSuccessFunc.length>0))for(r=0;r<i.onSuccessFunc.length;r++)i.onSuccessFunc[r]()}else if(i!=null&&i.sourceScreen!=null&&n.hide_gigyaScreen(i.sourceScreen),i!=null&&i.onFailFunc!=null&&i.onFailFunc.length>0)for(r=0;r<i.onFailFunc.length;r++)i.onFailFunc[r]();else n.errorHandler(t,null,t.GigyaError.ErrorCode)},n.GetAccountInfo=function(t){Actions.getAccountInfo(t,n.getAccountInfoHandler,function(){showMessage(Translation.get("LogErrorMessage"),MessageType.Error,DisplayType.Toast)})},n.getAccountInfoHandler=function(t){t!=null&&(t.GigyaError.ErrorCode==0?Logging.Debug("GetAccountInfo Success",LogType.Other):n.errorHandler(t,null,t.GigyaError.ErrorCode))},n.deactivateAccountHandler=function(t){var i,r;t!=null&&(t.ErrorCode.Id==200?(i=new ConfirmationDialog2Args,i.ID="pnlDeactiaveConfirmation",i.TitleText=Translation.get("AccountDeactivationConfirmation"),i.BodyContent=$("<span>"+Translation.get("AccountDeactivationConfirmationText")+"<\/span>"),i.ButtonPositiveText=Translation.get("OK"),i.ButtonPositiveOnClick=function(n,t){t.Featherlight.close()},i.ButtonNegativeOnClick=function(n,t){t.Featherlight.close()},i.AfterClose=function(){var t=new LogoutCallbackArgs;t.DT=DisplayType.Tempbox;n.Logout(t)},r=new ConfirmationDialogModel2(i.ID,i.TitleText,i.BodyContent,i.ButtonPositiveText,i.ButtonPositiveOnClick,null,i.ButtonNegativeOnClick,null,null,null,null,null,i.AfterClose),r.ShowCloseButton=!1,showConfirmationDialog2(r),window.setTimeout(function(){ConsumerProfile.UserAccountSettings.REALTOR_mail&&$("#pnlSubscriptionDeactiavateText").show()},320)):showMessage(t.ErrorCode.Description,MessageType.Error))},n.unfavouriteNoteConfirmation=function(t){var i=new ConfirmationDialog2Args,r;i.ID="pnlConfirmMsgUnfavouriteNote";i.TitleText=Translation.get("RemoveNoteHeader");i.BodyContent=$("<span>"+Translation.get("RemoveNoteBody")+"<\/span>");i.ButtonPositiveText=Translation.get("Yes");i.ButtonNegativeText=Translation.get("No");i.ButtonPositiveOnClick=function(i,r){$('.card[data-value="'+t.id+'"]').addClass("fadedOut");n.unfavouriteNoteConfirmationYes(t.toString());Favourite.refreshIcons($("body"));r.Featherlight.close()};i.ButtonNegativeOnClick=function(n,i){$('.card[data-value="'+t.id+'"]').removeClass("fadedOut");i.Featherlight.close()};r=new ConfirmationDialogModel2(i.ID,i.TitleText,i.BodyContent,i.ButtonPositiveText,i.ButtonPositiveOnClick,i.ButtonNegativeText,i.ButtonNegativeOnClick);r.ShowCloseButton=!1;showConfirmationDialog2(r)},n.unfavouriteNoteConfirmationYes=function(n){var t=Favourite.fromString(n),i=!1;typeof Pages.Listing!="undefined"&&(i=ApplicationState.IsMobileDevice?Pages.Listing.prototype.isPrototypeOf(ApplicationState.Current.Page):Pages.Desktop.Listing.prototype.isPrototypeOf(ApplicationState.Current.Page));Note.Delete(t.id,null,"",null,i);Favourite.AddOrRemove(t.id,t.latitude,t.longitude,"",ApplicationState.CurrentMode,!1,!0)},n.notesIncludeConfirmation=function(){var t=new ConfirmationDialog2Args,i;t.ID="pnlConfirmMsgNotesInclude";t.TitleText=Translation.get("T452");t.BodyContent=$("<span>"+Translation.get("M48")+"<\/span>");t.ButtonPositiveText=Translation.get("Yes");t.ButtonNegativeText=Translation.get("No");t.ButtonPositiveOnClick=function(t,i){var f={},u,r;f.Notes_include=!0;u=new AccountSetInfoArgs;u.data=JSON.stringify(f);u.CRM_update=!1;r=new SetAccountInfoCallbackArgs;ApplicationState.IsMobileDevice?r.onSuccessFunc.push(function(){Utilities.closeOpener(!0,Translation.get("EmailSentSuccessfully"))}):r.onSuccessFunc.push(function(){Events.Fire(Controls.Desktop.EmailAFriend.EmailSentSuccessfullyEvent)});r.onSuccessFunc.push(function(){i.Featherlight.close();showMessage(Translation.get("EmailSentSuccessfully"))});n.AccountSetInfo(u,r)};t.ButtonNegativeOnClick=function(n,t){t.Featherlight.close();ApplicationState.IsMobileDevice?Utilities.closeOpener(!0,Translation.get("EmailSentSuccessfully")):(Events.Fire(Controls.Desktop.EmailAFriend.EmailSentSuccessfullyEvent),showMessage(Translation.get("EmailSentSuccessfully")))};i=new ConfirmationDialogModel2(t.ID,t.TitleText,t.BodyContent,t.ButtonPositiveText,t.ButtonPositiveOnClick,t.ButtonNegativeText,t.ButtonNegativeOnClick);i.ShowCloseButton=!1;showConfirmationDialog2(i)},n.sortOrderTooltipMobileConfirmation=function(){var r=LocalStorage.SortOrderMessageGotIt.get(),t,i;r==""&&$("#pnlConfirmMsgSortTooltip_con").length<=0&&(t=new ConfirmationDialog2Args,t.ID="pnlConfirmMsgSortTooltip",t.BodyContent=$("<span>"+Translation.get("SortOrderMessageTextContent",RouteHelper.getURL("my-account")+"#section=ResultsView")+"<\/span>"),t.ButtonPositiveText=Translation.get("GotIt"),t.ButtonPositiveOnClick=function(n,t){LocalStorage.SortOrderMessageGotIt.save("1");t.Featherlight.close()},t.AfterOpen=function(){n.MobileSortMessageShown.Fire()},i=new ConfirmationDialogModel2(t.ID,t.TitleText,t.BodyContent,t.ButtonPositiveText,t.ButtonPositiveOnClick,null,null,null,null,null,null,t.AfterOpen),i.ShowCloseButton=!0,showConfirmationDialog2(i))},n.mapViewChangeConfirmation=function(t){var u=Cookie.FirstMapViewChange.get()?Cookie.FirstMapViewChange.get():null,i,r;(u==null||u=="0")&&$("#pnlConfirmMsgMapView_con").length<=0&&(i=new ConfirmationDialog2Args,i.ID="pnlConfirmMsgMapView",i.TitleText=Translation.get("T443"),i.BodyContent=$("<span>"+Translation.get("M51")+"<\/span>"),i.ButtonPositiveText=Translation.get("Yes"),i.ButtonNegativeText=Translation.get("No"),i.ButtonPositiveOnClick=function(i,r){var u,f,e,o;Cookie.FirstMapViewChange.save("1");u={};f={};f.viewOn=t;ApplicationState.CurrentMode==ApplicationModes.Residential?u.Res_View=f:u.Com_View=f;e=new AccountSetInfoArgs;e.data=JSON.stringify(u);e.CRM_update=!1;o=new SetAccountInfoCallbackArgs;o.onSuccessFunc.push(function(){r.Featherlight.close()});n.AccountSetInfo(e,o);n.MobileSortTooltipEvent()},i.ButtonNegativeOnClick=function(t,i){Cookie.FirstMapViewChange.save("1");i.Featherlight.close();n.MobileSortTooltipEvent()},r=new ConfirmationDialogModel2(i.ID,i.TitleText,i.BodyContent,i.ButtonPositiveText,i.ButtonPositiveOnClick,i.ButtonNegativeText,i.ButtonNegativeOnClick),r.ShowCloseButton=!1,showConfirmationDialog2(r))},n.MobileSortTooltipEvent=function(){SessionStorage.MobileSortMessageQueued.get()=="1"&&(n.sortOrderTooltipMobileConfirmation(),SessionStorage.MobileSortMessageQueued.delete())},n.startIdleTimeout=function(){$(document).idleTimeout({redirectUrl:!1,idleTimeLimit:172800,idleCheckHeartbeat:2,customCallback:function(){$.fn.idleTimeout().logout();var t=new LogoutCallbackArgs;t.DT=DisplayType.Lightbox;n.Logout(t)},activityEvents:"click keypress scroll wheel mousewheel mousemove touchstart touchmove",enableDialog:!1,sessionKeepAliveTimer:600,sessionKeepAliveUrl:window.location.href})},n.refreshEnableNotifications=function(){ConsumerProfile.UserAccountSettings.FavNotificationsEnabled=!0;$("#FaveNotifcationPreferencesLinkCon").length==1&&$("#FaveNotifcationPreferencesLinkCon").show();$("#FaveSendNotificationLinkCon").length==1&&$("#FaveSendNotificationLinkCon").hide()},n.enableFavouriteAndCompareNotifications=function(){var u={},r={},i,t;r.favourite=[new PublicContracts.ConsumerNotificationSetting({method:NotificationMethod.Email,frequency:NotificationFrequency.Daily,createdTimestampUTC:"",lastActionedTimestampUTC:"",id:""})];r.compares=!0;u.Notifications=r;i=new AccountSetInfoArgs;i.data=JSON.stringify(u);i.CRM_update=!1;t=new SetAccountInfoCallbackArgs;t.onSuccessMsg=Translation.get("FavouritesSendEmailNotificationMessage");t.onSuccessMsgDisplayType=DisplayType.Lightbox;t.onSuccessFunc.push(n.refreshEnableNotifications);n.AccountSetInfo(i,t)},n.resetDefaults=function(n,t){n=="ResultsView"?($("#ddlSortBy").val("6-D").trigger("change"),$("#ddlViewOn").val("m").trigger("change")):n=="ResultsViewCom"?($("#ddlSortByCom").val("6-D").trigger("change"),$("#ddlViewOnCom").val("m").trigger("change")):n=="SearchCriteria"&&t==1?($("#ddlProfileMeasurements").val("1").trigger("change"),$("#txtProfileLocation").val("").trigger("change"),$("#ddlProfilePropertyType").val("0").trigger("change"),$("#ddlProfileTransactionType").val("2").trigger("change"),$("#ddlBaths").val("0-0").trigger("change"),$("#ddlBeds").val("0-0").trigger("change"),$("#ddlNumberOfUnits").val("0-0").trigger("change"),$("#ddlMinPrice").val("0").trigger("change"),$("#ddlMaxPrice").val("0").trigger("change"),$("#ddlMinRent").val("0").trigger("change"),$("#ddlMaxRent").val("0").trigger("change"),$("#dteListedSince").val("").trigger("change"),$("#chkOpenHouse").prop("checked",!1).trigger("change"),$("#chkPublicOffers").prop("checked",!1).trigger("change"),$("#ddlBuildingType").val("0").trigger("change"),$("#ddlBuildingAttachmentStyle").val("0").trigger("change"),$("#ddlParkingType").val("0").trigger("change"),$("#ddlBuildingSpace").val("0-0").trigger("change"),$("#ddlLandSize").val("0-0").trigger("change"),$("#ddlFarmType").val("0").trigger("change"),$("#ddlZoningType").val("0").trigger("change"),ApplicationState.IsMobileDevice?$("#txtKeywords").val(""):$("#txtKeywords").val(null).trigger("change")):n=="SearchCriteria"&&t==2&&($("#ddlProfileMeasurementsCom").val("1").trigger("change"),$("#txtProfileLocationCom").val("").trigger("change"),$("#ddlProfilePropertyTypeCom").val("0").trigger("change"),$("#ddlProfileTransactionTypeCom").val("2").trigger("change"),$("#ddlBathsCom").val("0-0").trigger("change"),$("#ddlBedsCom").val("0-0").trigger("change"),$("#ddlNumberOfUnitsCom").val("0-0").trigger("change"),$("#ddlMinPriceCom").val("0").trigger("change"),$("#ddlMaxPriceCom").val("0").trigger("change"),$("#ddlMinRentCom").val("0").trigger("change"),$("#ddlMaxRentCom").val("0").trigger("change"),$("#dteListedSinceCom").val("").trigger("change"),$("#chkOpenHouseCom").prop("checked",!1).trigger("change"),$("#chkPublicOffersCom").prop("checked",!1).trigger("change"),$("#ddlBuildingTypeCom").val("0").trigger("change"),$("#ddlBuildingAttachmentStyleCom").val("0").trigger("change"),$("#ddlParkingTypeCom").val("0").trigger("change"),$("#ddlBuildingSpaceCom").val("0-0").trigger("change"),$("#ddlHospitalityBuildingType").val("0").trigger("change"),$("#ddlInstitutionalBuildingType").val("0").trigger("change"),$("#ddlIndustrialBuildingType").val("0").trigger("change"),$("#ddlRetailBuildingType").val("0").trigger("change"),$("#ddlLandSizeCom").val("0-0").trigger("change"),$("#ddlFarmTypeCom").val("0").trigger("change"),$("#ddlZoningTypeCom").val("0").trigger("change"),ApplicationState.IsMobileDevice?$("#txtKeywordsCom").val(""):$("#txtKeywordsCom").val(null).trigger("change"))},n.importCheck=function(t,i){var o;i===void 0&&(i=!1);var r=new ImportObject,s=Favourite.getAll(null,UserType.Guest),h=0,c=null,g=0,l=!1,nt=!1,u=[],a=[],v=0,y=null,tt=0,p=!1,it=!1,f=[],w=SavedSearch.GetAll(undefined,undefined,UserType.Guest),b=0,k=i?SavedSearch.GetAll(undefined,undefined,UserType.Consumer):(o=t===null||t===void 0?void 0:t.user)===null||o===void 0?void 0:o.Searches,rt=0,d=!1,ut=!1,e=[];return s!=null||a!=null||w!=null?(t.user.Favourites!=null&&(c=t.user.Favourites,g=c.length),s!=null&&(u=n.ArrayDiff(s,c),(u!=null||u.length!=0)&&(h=u.length,h>0&&(l=!0,g+h>ConsumerProfile.UserAccountSettings.FavouriteLimit&&(nt=!0)))),t.user.Compares!=null&&(y=t.user.Compares,tt=y.length),a!=null&&(f=n.ArrayDiff(a,y),(f!=null||f.length!=0)&&(v=f.length,v>0&&(p=!0,tt+v>ConsumerProfile.UserAccountSettings.CompareLimit&&(it=!0)))),k&&(rt=k.length),w!=null&&(e=n.ArrayDiff(w,k,diffType.name),(e!=null||e.length!=0)&&(b=e.length,b>0&&(d=!0,rt+b>ConsumerProfile.UserAccountSettings.SearchLimit&&(ut=!0)))),r.importFaveFlag=l,r.importCompareFlag=p,r.importSearchFlag=d,r.maxFaveFlag=nt,r.maxCompareFlag=it,r.maxSearchFlag=ut,r.FAVEdiff=u,r.COMPAREdiff=f,r.SEARCHdiff=e,l||p||d?SessionStorage.ConsumerImport.save(JSON.stringify(r)):(r=null,SessionStorage.ConsumerImport.save(""))):r=null,r},n.ArrayDiff=function(n,t,i){for(var e,o,s=[],f=[],u=[],r=0;r<n.length;r++)(parseInt(n[r].appMode)===ApplicationState.CurrentMode||parseInt(n[r].appMode)===ApplicationState.AlternateMode)&&u.push(n[r]);for(e=[],o=[],r=0;r<u.length;r++)i==diffType.name?e.push(u[r].name):e.push(parseInt(u[r].id));for(r=0;r<(t!=null?t.length:0);r++)i==diffType.name?o.push(t[r].name):o.push(parseInt(t[r].id));return f=$.grep(e,function(n){return $.inArray(n,o)==-1}),f.length>0&&(s=$.grep(u,function(n){return i==diffType.name?$.inArray(n.name,f)!=-1:$.inArray(parseInt(n.id),f)!=-1})),s},n.importConfirmation=function(){var t=function(){var r=SessionStorage.ConsumerImport.get(""),t=new ConfirmationDialog2Args,i;t.ID="pnlConfirmMsgImport";t.ButtonCloseOnClick=function(t){n.cancelImportGuest(t);n.GigyaScreenClose.Fire({screen:gigyaScreen.ImportConfirmation})};t.TitleText=Translation.get("T442");t.BeforeClose=function(){SessionStorage.ConsumerImport.delete();n.GigyaScreenClose.Fire({screen:gigyaScreen.ImportConfirmation})};t.BodyContent=$("<span>"+Translation.get("M34")+"<\/span>");t.ButtonPositiveText=Translation.get("Yes");t.ButtonPositiveOnClick=function(t,i){n.importGuest(r);i.Featherlight.close();n.GigyaScreenClose.Fire({screen:gigyaScreen.ImportConfirmation})};t.ButtonNegativeText=Translation.get("No");t.ButtonNegativeOnClick=function(t,i){n.cancelImportGuest(i);n.GigyaScreenClose.Fire({screen:gigyaScreen.ImportConfirmation})};i=new ConfirmationDialogModel2(t.ID,t.TitleText,t.BodyContent,t.ButtonPositiveText,t.ButtonPositiveOnClick,t.ButtonNegativeText,t.ButtonNegativeOnClick);ApplicationState.IsMobileDevice&&(i.ShowCloseButton=!1);showConfirmationDialog2(i)};t()},n.importGuest=function(t){var i=JSON.parse(t),s=i.maxFaveFlag!=!0&&i.importFaveFlag,h=i.maxSearchFlag!=!0&&i.importSearchFlag,r,v,y,o,c,l,u,a;if(i!=null){if(s)for(r=0;r<i.FAVEdiff.length;r++)try{Favourite.AddOrRemove(i.FAVEdiff[r].id,i.FAVEdiff[r].latitude,i.FAVEdiff[r].longitude,"import",i.FAVEdiff[r].appMode,!1,!1);r!==i.FAVEdiff.length-1||h||n.saveConsumerFavourites()}catch(k){}if(h)for(r=0;r<i.SEARCHdiff.length;r++)try{v=new SavedSearch(i.SEARCHdiff[r].name,i.SEARCHdiff[r].url,i.SEARCHdiff[r].appMode,i.SEARCHdiff[r].savedDate,i.SEARCHdiff[r].viewedDate);v.Save(!1);r!==i.SEARCHdiff.length-1||s||(o=!!SessionStorage.PostLoginRedirect.get("")||!!Cookie.FWDAccountURL.get(""),n.saveConsumerSearches(!o))}catch(k){}if(s&&h&&(y=JSON.parse(t),o=!!SessionStorage.PostLoginRedirect.get("")||!!Cookie.FWDAccountURL.get(""),n.combineConsumerDataAndSave(y,!o)),i.maxFaveFlag===!0||i.maxCompareFlag===!0||i.maxSearchFlag===!0){var e=Translation.get("M70"),p=Translation.get("M70Favourites"),w=Translation.get("M70Compares"),b=Translation.get("M70SavedSearches"),f=i.maxFaveFlag?p+", ":"";f+=i.maxCompareFlag?w+", ":"";f+=i.maxSearchFlag?b+", ":"";f!=""&&(f=f.substring(0,f.length-2));c="[FCS1]";l="[FCS2]";e.indexOf(c)>-1&&(e=e.replace(c,f));e.indexOf(l)>-1&&(e=e.replace(l,f));u=new ConfirmationDialog2Args;u.ID="pnlMaxImportMsg";u.BodyContent=$("<span>"+e+"<\/span>");u.ButtonPositiveText=Translation.get("OK");u.ButtonPositiveOnClick=function(n,t){GigyaInit.ShiftDialogs();t.Featherlight.close()};a=new ConfirmationDialogModel2(u.ID,u.TitleText,u.BodyContent,u.ButtonPositiveText,u.ButtonPositiveOnClick);a.ShowCloseButton=!1;showConfirmationDialog2(a)}else GigyaInit.ShiftDialogs();SessionStorage.ConsumerImport.delete()}else GigyaInit.ShiftDialogs()},n.cancelImportGuest=function(n){SessionStorage.ConsumerImport.delete();GigyaInit.ShiftDialogs();n.Featherlight.close()},n.PageCurrentSearchMode=function(){var n;return ApplicationState.IsMobileDevice?n=ApplicationState.CurrentHref.indexOf(RouteHelper.getURL(""))>-1?$("#btnHomeMode_Res").hasClass("selected")?ApplicationModes.Residential:ApplicationModes.Commercial:ApplicationState.CurrentHref.indexOf(RouteHelper.getURL("map"))>-1?$("#btnMapMode_Res").hasClass("selected")?ApplicationModes.Residential:ApplicationModes.Commercial:ApplicationState.CurrentMode:$("#homeResidentialTab.active").is(":visible")?n=ApplicationModes.Residential:$("#homeCommercialTab.active").is(":visible")&&(n=ApplicationModes.Commercial),n},n.GetDaysFromDate=function(n){var t;t=stringToDate(n);t.setDate(t.getDate());var i=new Date,r=new Date(i.getFullYear(),i.getMonth(),i.getDate());return(Math.round(Math.abs((t.getTime()-r.getTime())/864e5))+1).toString()},n.loadConsumerSearchPref=function(t,i,r){var v,h,c,y,l,a,u,e,s;try{if(ApplicationState.UserIsSignedIn){if(i==null?(i=new ConsumerProfile.Consumer(null),i.Interested=AccountSessionStorage.TransactionTypeId.get(),i.Interested_Com=AccountSessionStorage.TransactionTypeId_Com.get()):(AccountSessionStorage.TransactionTypeId.save(i.Interested),AccountSessionStorage.TransactionTypeId_Com.save(i.Interested_Com)),i.user.Res_Search!=null&&(i.user.Res_Search.measurements==MeasurementUnits.Metric.toString()?Cookie.PreferredMeasurementUnits.save(MeasurementUnits.Metric.toString()):Cookie.PreferredMeasurementUnits.save(MeasurementUnits.Imperial.toString()),GigyaInit.Events.consumerMeasurementsLoaded.Fire()),t==ApplicationModes.Residential&&i.user.Res_Search!=null){if($("#homeSearchTxt").val(i.user.Res_Search.location),$("#ddlPropertyTypeRes").val(i.user.Res_Search.propertyType).trigger("change"),$("#ddlTransactionTypeTopRes").val(i.Interested).trigger("change"),ApplicationState.IsMobileDevice){GigyaInit.ConsumerSearchCriteria={};r&&$("#homeSearchInput").val(i.user.Res_Search.location);GigyaInit.ConsumerSearchCriteria.PropertyTypeGroupID=1;GigyaInit.ConsumerSearchCriteria.PropertySearchTypeId=i.user.Res_Search.propertyType;GigyaInit.ConsumerSearchCriteria.TransactionTypeId=i.Interested;var p=!1,w=!1,b=$('#ddlMaxPriceHP [value="'+i.user.Res_Search.priceMax+'"]').val();(b||"")==""&&(GigyaInit.ConsumerSearchCriteria.PriceMaxExact=1,p=!0);v=$('#ddlMinPriceHP [value="'+i.user.Res_Search.priceMin+'"]').val();(v||"")==""&&(GigyaInit.ConsumerSearchCriteria.PriceMinExact=1,w=!0);h="";c="";h=Math.round(Number(i.user.Res_Search.priceMax)*ApplicationState.CurrencyMultiplier).toString();c=Math.round(Number(i.user.Res_Search.priceMin)*ApplicationState.CurrencyMultiplier).toString();GigyaInit.ConsumerSearchCriteria.PriceMax=h;GigyaInit.ConsumerSearchCriteria.PriceMin=c;var k=!1,d=!1,g=$('#ddlMaxRentHP [value="'+i.user.Res_Search.rentMax+'"]').val();(g||"")==""&&(GigyaInit.ConsumerSearchCriteria.RentMaxExact=1,k=!0);y=$('#ddlMinRentHP [value="'+i.user.Res_Search.rentMin+'"]').val();(y||"")==""&&(GigyaInit.ConsumerSearchCriteria.RentMinExact=1,d=!0);l="";a="";l=Math.round(Number(i.user.Res_Search.rentMax)*ApplicationState.CurrencyMultiplier).toString();a=Math.round(Number(i.user.Res_Search.rentMin)*ApplicationState.CurrencyMultiplier).toString();GigyaInit.ConsumerSearchCriteria.RentMax=l;GigyaInit.ConsumerSearchCriteria.RentMin=a;GigyaInit.ConsumerSearchCriteria.BedRange=i.user.Res_Search.bedrooms;GigyaInit.ConsumerSearchCriteria.BathRange=i.user.Res_Search.bathrooms;GigyaInit.ConsumerSearchCriteria.UnitRange=i.user.Res_Search.numberOfUnits;GigyaInit.ConsumerSearchCriteria.BuildingSizeRange=i.user.Res_Search.buildingSize!="0-0"?i.user.Res_Search.buildingSize:"";GigyaInit.ConsumerSearchCriteria.FarmTypeId=i.user.Res_Search.farmType;GigyaInit.ConsumerSearchCriteria.ParkingTypeId=i.user.Res_Search.parkingType;GigyaInit.ConsumerSearchCriteria.LandSizeRange=i.user.Res_Search.landSize!="0-0"?i.user.Res_Search.landSize:"";GigyaInit.ConsumerSearchCriteria.ZoningTypeGroupId=i.user.Res_Search.zoning;GigyaInit.ConsumerSearchCriteria.NumberOfDays=n.GetDaysFromDate(i.user.Res_Search.listedSince);GigyaInit.ConsumerSearchCriteria.OpenHouse=i.user.Res_Search.openHouse?"1":"0";GigyaInit.ConsumerSearchCriteria.PublicOffers=i.user.Res_Search.publicOffers?"1":"0";GigyaInit.ConsumerSearchCriteria.BuildingTypeId=i.user.Res_Search.buildingType!="0"?i.user.Res_Search.buildingType:"";GigyaInit.ConsumerSearchCriteria.ConstructionStyleId=i.user.Res_Search.buildingStyle;GigyaInit.ConsumerSearchCriteria.Keywords=i.user.Res_Search.keywords}if(ApplicationState.CurrencyID===0)$("#ddlMaxPriceTop").find("option[value='"+i.user.Res_Search.priceMax+"']").length?$("#ddlMaxPriceTop").val(i.user.Res_Search.priceMax).trigger("change"):(u=new Option(Number(i.user.Res_Search.priceMax).toLocaleString(ApplicationState.LanguageAttribute),i.user.Res_Search.priceMax.toString(),!0,!0),u.setAttribute("data-cad",i.user.Res_Search.priceMax.toString()),$("#ddlMaxPriceTop").append(u).trigger("change")),$("#ddlMinPriceTop").find("option[value='"+i.user.Res_Search.priceMin+"']").length?$("#ddlMinPriceTop").val(i.user.Res_Search.priceMin).trigger("change"):(u=new Option(Number(i.user.Res_Search.priceMin).toLocaleString(ApplicationState.LanguageAttribute),i.user.Res_Search.priceMin.toString(),!0,!0),u.setAttribute("data-cad",i.user.Res_Search.priceMin.toString()),$("#ddlMinPriceTop").append(u).trigger("change")),$("#ddlMaxRentTop").find("option[value='"+i.user.Res_Search.rentMax+"']").length?$("#ddlMaxRentTop").val(i.user.Res_Search.rentMax).trigger("change"):(u=new Option(Number(i.user.Res_Search.rentMax).toLocaleString(ApplicationState.LanguageAttribute),i.user.Res_Search.rentMax.toString(),!0,!0),u.setAttribute("data-cad",i.user.Res_Search.rentMax.toString()),$("#ddlMaxRentTop").append(u).trigger("change")),$("#ddlMinRentTop").find("option[value='"+i.user.Res_Search.rentMin+"']").length?$("#ddlMinRentTop").val(i.user.Res_Search.rentMin).trigger("change"):(u=new Option(Number(i.user.Res_Search.rentMin).toLocaleString(ApplicationState.LanguageAttribute),i.user.Res_Search.rentMin.toString(),!0,!0),u.setAttribute("data-cad",i.user.Res_Search.rentMin.toString()),$("#ddlMinRentTop").append(u).trigger("change"));else{if($("#ddlMaxPriceTop").find("option[data-cad='"+i.user.Res_Search.priceMax+"']").length)$("#ddlMaxPriceTop option[data-cad='"+i.user.Res_Search.priceMax+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Res_Search.priceMax)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Res_Search.priceMax);$("#ddlMaxPriceTop").append(u).trigger("change")}if($("#ddlMinPriceTop").find("option[data-cad='"+i.user.Res_Search.priceMin+"']").length)$("#ddlMinPriceTop option[data-cad='"+i.user.Res_Search.priceMin+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Res_Search.priceMin)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Res_Search.priceMin);$("#ddlMinPriceTop").append(u).trigger("change")}if($("#ddlMaxRentTop").find("option[data-cad='"+i.user.Res_Search.rentMax+"']").length)$("#ddlMaxRentTop option[data-cad='"+i.user.Res_Search.rentMax+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Res_Search.rentMax)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Res_Search.rentMax);$("#ddlMaxRentTop").append(u).trigger("change")}if($("#ddlMinRentTop").find("option[data-cad='"+i.user.Res_Search.rentMin+"']").length)$("#ddlMinRentTop option[data-cad='"+i.user.Res_Search.rentMin+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Res_Search.rentMin)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Res_Search.rentMin);$("#ddlMinRentTop").append(u).trigger("change")}}if($("#ddlBedsTop").val(i.user.Res_Search.bedrooms).trigger("change"),$("#ddlBathsTop").val(i.user.Res_Search.bathrooms).trigger("change"),$("#ddlNumberOfUnitsTop").val(i.user.Res_Search.numberOfUnits).trigger("change"),$("#ddlStoreys").val(i.user.Res_Search.storeys).trigger("change"),$("#ddlOwnershipType").val(i.user.Res_Search.ownership).trigger("change"),$("#ddlBuildingSpaceTop").val(i.user.Res_Search.buildingSize).trigger("change"),$("#ddlFarmTypeTop").val(i.user.Res_Search.farmType.split(",")).trigger("change"),$("#ddlParkingTypeTop").val(i.user.Res_Search.parkingType.split(",")).trigger("change"),$("#ddlLandSizeTop").val(i.user.Res_Search.landSize).trigger("change"),$("#ddlZoningTypeTop").val(i.user.Res_Search.zoning.split(",")).trigger("change"),$("#dteListedSince").val(i.user.Res_Search.listedSince),$("#chkOpenHouse").prop("checked",i.user.Res_Search.openHouse),$("#chkPublicOffers").prop("checked",i.user.Res_Search.publicOffers),$("#ddlBuildingType").val(i.user.Res_Search.buildingType!="0"?i.user.Res_Search.buildingType:" ").trigger("change"),$("#ddlBuildingAttachmentStyle").val(i.user.Res_Search.buildingStyle.split(",")).trigger("change"),i.user.Res_Search.keywords!=null&&i.user.Res_Search.keywords!="")if($("#txtKeywords").val(null).trigger("change"),e=i.user.Res_Search.keywords.split(","),ApplicationState.IsMobileDevice)for(e.length>0&&$("#txtKeywords").val(e[0]),s=1;s<e.length;s++)$("#txtKeywords").val($("#txtKeywords").val()+", "+e[s]);else $.each(i.user.Res_Search.keywords.split(","),function(n,t){$("#txtKeywords").find('option[value="'+t+'"]').remove();var i=new Option(t,t,!0,!0);$("#txtKeywords").append(i).trigger("change")})}if(t==ApplicationModes.Commercial&&i.user.Com_Search!=null){if($("#homeSearchTxt, #txtMapSearchInput").val(i.user.Com_Search.location),$("#ddlPropertyTypeCom").val(i.user.Com_Search.propertyType).trigger("change"),$("#ddlTransactionTypeTopCom").val(i.Interested_Com).trigger("change"),ApplicationState.IsMobileDevice){GigyaInit.ConsumerSearchCriteria={};r&&$("#homeSearchInput").val(i.user.Com_Search.location);GigyaInit.ConsumerSearchCriteria.PropertyTypeGroupID=2;GigyaInit.ConsumerSearchCriteria.PropertySearchTypeId=i.user.Com_Search.propertyType;GigyaInit.ConsumerSearchCriteria.TransactionTypeId=i.Interested_Com;var p=!1,w=!1,b=$('#ddlMaxPriceHP [value="'+i.user.Com_Search.priceMax+'"]').val();(b||"")==""&&(GigyaInit.ConsumerSearchCriteria.PriceMaxExact=1,p=!0);v=$('#ddlMinPriceHP [value="'+i.user.Com_Search.priceMin+'"]').val();(v||"")==""&&(GigyaInit.ConsumerSearchCriteria.PriceMinExact=1,w=!0);h="";c="";h=Math.round(Number(i.user.Com_Search.priceMax)*ApplicationState.CurrencyMultiplier).toString();c=Math.round(Number(i.user.Com_Search.priceMin)*ApplicationState.CurrencyMultiplier).toString();GigyaInit.ConsumerSearchCriteria.PriceMax=h;GigyaInit.ConsumerSearchCriteria.PriceMin=c;var k=!1,d=!1,g=$('#ddlMaxRentHP [value="'+i.user.Com_Search.rentMax+'"]').val();(g||"")==""&&(GigyaInit.ConsumerSearchCriteria.RentMaxExact=1,k=!0);y=$('#ddlMinRentHP [value="'+i.user.Com_Search.rentMin+'"]').val();(y||"")==""&&(GigyaInit.ConsumerSearchCriteria.RentMinExact=1,d=!0);l="";a="";l=Math.round(Number(i.user.Com_Search.rentMax)*ApplicationState.CurrencyMultiplier).toString();a=Math.round(Number(i.user.Com_Search.rentMin)*ApplicationState.CurrencyMultiplier).toString();GigyaInit.ConsumerSearchCriteria.RentMax=l;GigyaInit.ConsumerSearchCriteria.RentMin=a;GigyaInit.ConsumerSearchCriteria.BedRange=i.user.Com_Search.bedrooms;GigyaInit.ConsumerSearchCriteria.BathRange=i.user.Com_Search.bathrooms;GigyaInit.ConsumerSearchCriteria.UnitRange=i.user.Com_Search.numberOfUnits;GigyaInit.ConsumerSearchCriteria.BuildingSizeRange=i.user.Com_Search.buildingSize!="0-0"?i.user.Com_Search.buildingSize:"";GigyaInit.ConsumerSearchCriteria.FarmTypeId=i.user.Com_Search.farmType;GigyaInit.ConsumerSearchCriteria.ParkingTypeId=i.user.Com_Search.parkingType;GigyaInit.ConsumerSearchCriteria.LandSizeRange=i.user.Com_Search.landSize!="0-0"?i.user.Com_Search.landSize:"";GigyaInit.ConsumerSearchCriteria.ZoningTypeGroupId=i.user.Com_Search.zoning;GigyaInit.ConsumerSearchCriteria.NumberOfDays=n.GetDaysFromDate(i.user.Com_Search.listedSince);GigyaInit.ConsumerSearchCriteria.OpenHouse=i.user.Com_Search.openHouse?"1":"0";GigyaInit.ConsumerSearchCriteria.PublicOffers=i.user.Com_Search.publicOffers?"1":"0";GigyaInit.ConsumerSearchCriteria.BuildingTypeId=i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:"";GigyaInit.ConsumerSearchCriteria.ConstructionStyleId=i.user.Com_Search.buildingStyle;GigyaInit.ConsumerSearchCriteria.Keywords=i.user.Com_Search.keywords}if(ApplicationState.CurrencyID===0)$("#ddlMaxPriceTop").find("option[value='"+i.user.Com_Search.priceMax+"']").length?$("#ddlMaxPriceTop").val(i.user.Com_Search.priceMax).trigger("change"):(u=new Option(Number(i.user.Com_Search.priceMax).toLocaleString(ApplicationState.LanguageAttribute),i.user.Com_Search.priceMax.toString(),!0,!0),u.setAttribute("data-cad",i.user.Com_Search.priceMax.toString()),$("#ddlMaxPriceTop").append(u).trigger("change")),$("#ddlMinPriceTop").find("option[value='"+i.user.Com_Search.priceMin+"']").length?$("#ddlMinPriceTop").val(i.user.Com_Search.priceMin).trigger("change"):(u=new Option(Number(i.user.Com_Search.priceMin).toLocaleString(ApplicationState.LanguageAttribute),i.user.Com_Search.priceMin.toString(),!0,!0),u.setAttribute("data-cad",i.user.Com_Search.priceMin.toString()),$("#ddlMinPriceTop").append(u).trigger("change")),$("#ddlMaxRentTop").find("option[value='"+i.user.Com_Search.rentMax+"']").length?$("#ddlMaxRentTop").val(i.user.Com_Search.rentMax).trigger("change"):(u=new Option(Number(i.user.Com_Search.rentMax).toLocaleString(ApplicationState.LanguageAttribute),i.user.Com_Search.rentMax.toString(),!0,!0),u.setAttribute("data-cad",i.user.Com_Search.rentMax.toString()),$("#ddlMaxRentTop").append(u).trigger("change")),$("#ddlMinRentTop").find("option[value='"+i.user.Com_Search.rentMin+"']").length?$("#ddlMinRentTop").val(i.user.Com_Search.rentMin).trigger("change"):(u=new Option(Number(i.user.Com_Search.rentMin).toLocaleString(ApplicationState.LanguageAttribute),i.user.Com_Search.rentMin.toString(),!0,!0),u.setAttribute("data-cad",i.user.Com_Search.rentMin.toString()),$("#ddlMinRentTop").append(u).trigger("change"));else{if($("#ddlMaxPriceTop").find("option[data-cad='"+i.user.Com_Search.priceMax+"']").length)$("#ddlMaxPriceTop option[data-cad='"+i.user.Com_Search.priceMax+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Com_Search.priceMax)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Com_Search.priceMax);$("#ddlMaxPriceTop").append(u).trigger("change")}if($("#ddlMinPriceTop").find("option[data-cad='"+i.user.Com_Search.priceMin+"']").length)$("#ddlMinPriceTop option[data-cad='"+i.user.Com_Search.priceMin+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Com_Search.priceMin)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Com_Search.priceMin);$("#ddlMinPriceTop").append(u).trigger("change")}if($("#ddlMaxRentTop").find("option[data-cad='"+i.user.Com_Search.rentMax+"']").length)$("#ddlMaxRentTop option[data-cad='"+i.user.Com_Search.rentMax+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Com_Search.rentMax)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Com_Search.rentMax);$("#ddlMaxRentTop").append(u).trigger("change")}if($("#ddlMinRentTop").find("option[data-cad='"+i.user.Com_Search.rentMin+"']").length)$("#ddlMinRentTop option[data-cad='"+i.user.Com_Search.rentMin+"']").prop("selected",!0).trigger("change");else{var f=Math.round(Number(i.user.Com_Search.rentMin)*ApplicationState.CurrencyMultiplier),o=f.toLocaleString(ApplicationState.LanguageAttribute),u=new Option(o,f.toString(),!0,!0);u.setAttribute("data-cad",i.user.Com_Search.rentMin);$("#ddlMinRentTop").append(u).trigger("change")}}if($("#ddlBedsTop").val(i.user.Com_Search.bedrooms).trigger("change"),$("#ddlBathsTop").val(i.user.Com_Search.bathrooms).trigger("change"),$("#ddlNumberOfUnitsTop").val(i.user.Com_Search.numberOfUnits).trigger("change"),$("#ddlBuildingSpaceTop").val(i.user.Com_Search.buildingSize).trigger("change"),$("#ddlFarmTypeTop").val(i.user.Com_Search.farmType.split(",")).trigger("change"),$("#ddlParkingTypeTop").val(i.user.Com_Search.parkingType.split(",")).trigger("change"),$("#ddlLandSizeTop").val(i.user.Com_Search.landSize).trigger("change"),$("#ddlZoningTypeTop").val(i.user.Com_Search.zoning.split(",")).trigger("change"),$("#dteListedSince").val(i.user.Com_Search.listedSince),$("#chkOpenHouse").prop("checked",i.user.Com_Search.openHouse),$("#chkPublicOffers").prop("checked",i.user.Com_Search.publicOffers),$("#ddlBuildingType").val(i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:" ").trigger("change"),$("#ddlHospitalityBuildingType").val(i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:" ").trigger("change"),$("#ddlInstitutionalBuildingType").val(i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:" ").trigger("change"),$("#ddlIndustrialBuildingType").val(i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:" ").trigger("change"),$("#ddlRetailBuildingType").val(i.user.Com_Search.buildingType!="0"?i.user.Com_Search.buildingType:" ").trigger("change"),$("#ddlBuildingAttachmentStyle").val(i.user.Com_Search.buildingStyle.split(",")).trigger("change"),i.user.Com_Search.keywords!=null&&i.user.Com_Search.keywords!="")if($("#txtKeywords").val(null).trigger("change"),e=i.user.Com_Search.keywords.split(","),ApplicationState.IsMobileDevice)for(e.length>0&&$("#txtKeywords").val(e[0]),s=1;s<e.length;s++)$("#txtKeywords").val($("#txtKeywords").val()+", "+e[s]);else $.each(i.user.Com_Search.keywords.split(","),function(n,t){$("#txtKeywords").find('option[value="'+t+'"]').remove();var i=new Option(t,t,!0,!0);$("#txtKeywords").append(i).trigger("change")})}GigyaInit.Events.consumerPreferenceLoaded.Fire({loaded:!0})}}catch(nt){}},n.runAfterScreensClosed=function(t,i,r,u){var f,e;u===void 0&&(u=function(){return GigyaLastPostFormMsg==null||(GigyaLastPostFormMsg===null||GigyaLastPostFormMsg===void 0?void 0:GigyaLastPostFormMsg.formType)!=formType.signUp&&(GigyaLastPostFormMsg===null||GigyaLastPostFormMsg===void 0?void 0:GigyaLastPostFormMsg.screenRender)!=null});f=!1;Events.RemoveListeners({uniqueKey:"ProfileAccountInfoStartUpdate_gigya"});Events.Listen(n.ProfileAccountInfoStartUpdate,function(){f=!0;Events.RemoveListeners({uniqueKey:"ProfileAccountInfoStartUpdate_gigya"})},{uniqueKey:"ProfileAccountInfoStartUpdate_gigya"});Events.RemoveListeners({uniqueKey:"ProfileAccountInfoIsSet_gigya"});n.ProfileAccountInfoIsSet.Listen(function(){f=!1;t.length==0&&i();Events.RemoveListeners({uniqueKey:"ProfileAccountInfoIsSet_gigya"})},{uniqueKey:"ProfileAccountInfoIsSet_gigya"});e=function(t,i,r){Events.RemoveListeners({uniqueKey:"gigyascreenclose_gigya"});(t===null||t===void 0?void 0:t.length)>0?n.GigyaScreenClose.Listen(function(n){var o;t[0]==((o=n.detail)===null||o===void 0?void 0:o.screen)&&(t[0]==gigyaScreen.SignIn?(t.shift(),ApplicationState.UserIsSignedIn&&u()?(Events.RemoveListeners({uniqueKey:"consumerLoggedIn_gigya"}),GigyaInit.Events.consumerLoggedIn.ListenOnce(function(n){var u,t=(u=n===null||n===void 0?void 0:n.detail)===null||u===void 0?void 0:u.dialogsQueue;t=t===null||t===void 0?void 0:t.filter(function(n){return(r===null||r===void 0?void 0:r.length)>0?r.indexOf(n)<0:!0});e(t,i)},{uniqueKey:"consumerLoggedIn_gigya"})):f||(Events.RemoveListeners({uniqueKey:"gigyascreenclose_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoIsSet_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoStartUpdate_gigya"}),i())):(t.shift(),t.length>0?e(t,i):f||(Events.RemoveListeners({uniqueKey:"gigyascreenclose_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoIsSet_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoStartUpdate_gigya"}),i())),Events.RemoveListeners({uniqueKey:"gigyascreenclose_gigya"}))},{uniqueKey:"gigyascreenclose_gigya"}):f||(Events.RemoveListeners({uniqueKey:"gigyascreenclose_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoIsSet_gigya"}),Events.RemoveListeners({uniqueKey:"ProfileAccountInfoStartUpdate_gigya"}),i())};e(t,i,r)},n.ProfileSortExpired=new RealtorEvent("ProfileSortExpired"),n.MobileSortMessageShown=new RealtorEvent("MobileSortMessageShown"),n.ProfileAccountInfoIsSet=new RealtorEvent("ProfileAccountInfoIsSet"),n.ProfileAccountInfoStartUpdate="ProfileAccountInfoStartUpdate",n.DeferredImportSavedSearches=new RealtorEvent("DeferredImportSavedSearches"),n.GigyaScreenClose=new RealtorEvent("GigyaScreenClose"),n.GigyaScreenOpen=new RealtorEvent("GigyaScreenOpen"),n}()